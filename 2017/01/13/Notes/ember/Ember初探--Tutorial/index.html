<!DOCTYPE html>
<html>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Table of Contents  generated with DocToc

Ember初探–Tutorial
创建新的应用
初始化应用
目录结构
start server


测试先行
Routes &amp;amp; Templates
新建about路由
新建contact路由
使用{{link-to}}编写导航
增加首页
各页面使用通用的导航栏


Model
安装附加插件
ember-">
<meta property="og:type" content="article">
<meta property="og:title" content="Ember初探--Tutorial">
<meta property="og:url" content="http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/index.html">
<meta property="og:site_name" content="ecmadao">
<meta property="og:description" content="Table of Contents  generated with DocToc

Ember初探–Tutorial
创建新的应用
初始化应用
目录结构
start server


测试先行
Routes &amp;amp; Templates
新建about路由
新建contact路由
使用{{link-to}}编写导航
增加首页
各页面使用通用的导航栏


Model
安装附加插件
ember-">
<meta property="og:image" content="http://ecmadao.com/images/ember_tutorial/style-super-rentals-maps.png">
<meta property="og:image" content="http://ecmadao.com/images/ember_tutorial/ember-super-rentals-about.png">
<meta property="og:image" content="http://ecmadao.com/images/ember_tutorial/super-rentals-index-with-list.png">
<meta property="og:image" content="http://ecmadao.com/images/ember_tutorial/styled-super-rentals-basic.png">
<meta property="og:image" content="http://ecmadao.com/images/ember_tutorial/styled-rental-listings.png">
<meta property="og:image" content="http://ecmadao.com/images/ember_tutorial/styled-super-rentals-filter.png">
<meta property="og:updated_time" content="2017-01-14T12:11:43.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ember初探--Tutorial">
<meta name="twitter:description" content="Table of Contents  generated with DocToc

Ember初探–Tutorial
创建新的应用
初始化应用
目录结构
start server


测试先行
Routes &amp;amp; Templates
新建about路由
新建contact路由
使用{{link-to}}编写导航
增加首页
各页面使用通用的导航栏


Model
安装附加插件
ember-">
<meta name="twitter:image" content="http://ecmadao.com/images/ember_tutorial/style-super-rentals-maps.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Ember初探--Tutorial</title>
    <!-- styles -->
    <link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/lib/meslo-LG/styles.css">
    <link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
    <!-- jquery -->
    <script src="/lib/jquery/jquery.min.js"></script>
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="http://github.com/probberechts">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2017/01/13/Notes/ember/Ember初探--Ember中的对象/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li>
        
        
        <li><a class="icon" href="/2017/01/13/Notes/ember/Ember初步--Template/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/&text=Ember初探--Tutorial"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/&title=Ember初探--Tutorial"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/&is_video=false&description=Ember初探--Tutorial"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Ember初探--Tutorial&body=Check out this article: http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/&title=Ember初探--Tutorial"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/&title=Ember初探--Tutorial"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/&title=Ember初探--Tutorial"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/&title=Ember初探--Tutorial"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/&name=Ember初探--Tutorial&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Ember初探–Tutorial"><span class="toc-number">1.</span> <span class="toc-text">Ember初探–Tutorial</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建新的应用"><span class="toc-number">1.1.</span> <span class="toc-text">创建新的应用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#初始化应用"><span class="toc-number">1.1.1.</span> <span class="toc-text">初始化应用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#目录结构"><span class="toc-number">1.1.2.</span> <span class="toc-text">目录结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#start-server"><span class="toc-number">1.1.3.</span> <span class="toc-text">start server</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试先行"><span class="toc-number">1.2.</span> <span class="toc-text">测试先行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Routes-amp-Templates"><span class="toc-number">1.3.</span> <span class="toc-text">Routes & Templates</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#新建about路由"><span class="toc-number">1.3.1.</span> <span class="toc-text">新建about路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#新建contact路由"><span class="toc-number">1.3.2.</span> <span class="toc-text">新建contact路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用-lt-￼51-gt-编写导航"><span class="toc-number">1.3.3.</span> <span class="toc-text">使用{{link-to}}编写导航</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#增加首页"><span class="toc-number">1.3.4.</span> <span class="toc-text">增加首页</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#各页面使用通用的导航栏"><span class="toc-number">1.3.5.</span> <span class="toc-text">各页面使用通用的导航栏</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Model"><span class="toc-number">1.4.</span> <span class="toc-text">Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装附加插件"><span class="toc-number">1.5.</span> <span class="toc-text">安装附加插件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ember-cli-tutorial-style"><span class="toc-number">1.5.1.</span> <span class="toc-text">ember-cli-tutorial-style</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ember-cli-mirage"><span class="toc-number">1.5.2.</span> <span class="toc-text">ember-cli-mirage</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用Ember-Data"><span class="toc-number">1.6.</span> <span class="toc-text">使用Ember Data</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#更新Model-Hook（route-handler）"><span class="toc-number">1.6.1.</span> <span class="toc-text">更新Model Hook（route handler）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#建立简单的组件"><span class="toc-number">1.7.</span> <span class="toc-text">建立简单的组件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#组件的组成"><span class="toc-number">1.7.1.</span> <span class="toc-text">组件的组成</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#放大-缩小图片"><span class="toc-number">1.7.2.</span> <span class="toc-text">放大/缩小图片</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#建立Handlebars-Helper"><span class="toc-number">1.8.</span> <span class="toc-text">建立Handlebars Helper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#建立复杂组件"><span class="toc-number">1.9.</span> <span class="toc-text">建立复杂组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Services-and-Utilities"><span class="toc-number">1.10.</span> <span class="toc-text">Services and Utilities</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#部署"><span class="toc-number">1.11.</span> <span class="toc-text">部署</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Ember初探--Tutorial
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">ecmadao</span>
      </span>
      
    <div class="postdate">
        <time datetime="2017-01-13T05:58:37.000Z" itemprop="datePublished">2017-01-13</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/ember/">ember</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<p><strong>Table of Contents</strong>  <em>generated with <a href="https://github.com/thlorenz/doctoc" target="_blank" rel="external">DocToc</a></em></p>
<ul>
<li><a href="#ember%E5%88%9D%E6%8E%A2--tutorial">Ember初探–Tutorial</a><ul>
<li><a href="#%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E5%BA%94%E7%94%A8">创建新的应用</a><ul>
<li><a href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E5%BA%94%E7%94%A8">初始化应用</a></li>
<li><a href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84">目录结构</a></li>
<li><a href="#start-server">start server</a></li>
</ul>
</li>
<li><a href="#%E6%B5%8B%E8%AF%95%E5%85%88%E8%A1%8C">测试先行</a></li>
<li><a href="#routes-&amp;-templates">Routes &amp; Templates</a><ul>
<li><a href="#%E6%96%B0%E5%BB%BAabout%E8%B7%AF%E7%94%B1">新建about路由</a></li>
<li><a href="#%E6%96%B0%E5%BB%BAcontact%E8%B7%AF%E7%94%B1">新建contact路由</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8link-to%E7%BC%96%E5%86%99%E5%AF%BC%E8%88%AA">使用<code>{{link-to}}</code>编写导航</a></li>
<li><a href="#%E5%A2%9E%E5%8A%A0%E9%A6%96%E9%A1%B5">增加首页</a></li>
<li><a href="#%E5%90%84%E9%A1%B5%E9%9D%A2%E4%BD%BF%E7%94%A8%E9%80%9A%E7%94%A8%E7%9A%84%E5%AF%BC%E8%88%AA%E6%A0%8F">各页面使用通用的导航栏</a></li>
</ul>
</li>
<li><a href="#model">Model</a></li>
<li><a href="#%E5%AE%89%E8%A3%85%E9%99%84%E5%8A%A0%E6%8F%92%E4%BB%B6">安装附加插件</a><ul>
<li><a href="#ember-cli-tutorial-style">ember-cli-tutorial-style</a></li>
<li><a href="#ember-cli-mirage">ember-cli-mirage</a></li>
</ul>
</li>
<li><a href="#%E4%BD%BF%E7%94%A8ember-data">使用Ember Data</a><ul>
<li><a href="#%E6%9B%B4%E6%96%B0model-hook%EF%BC%88route-handler%EF%BC%89">更新Model Hook（route handler）</a></li>
</ul>
</li>
<li><a href="#%E5%BB%BA%E7%AB%8B%E7%AE%80%E5%8D%95%E7%9A%84%E7%BB%84%E4%BB%B6">建立简单的组件</a><ul>
<li><a href="#%E7%BB%84%E4%BB%B6%E7%9A%84%E7%BB%84%E6%88%90">组件的组成</a></li>
<li><a href="#%E6%94%BE%E5%A4%A7%E7%BC%A9%E5%B0%8F%E5%9B%BE%E7%89%87">放大/缩小图片</a></li>
</ul>
</li>
<li><a href="#%E5%BB%BA%E7%AB%8Bhandlebars-helper">建立Handlebars Helper</a></li>
<li><a href="#%E5%BB%BA%E7%AB%8B%E5%A4%8D%E6%9D%82%E7%BB%84%E4%BB%B6">建立复杂组件</a></li>
<li><a href="#services-and-utilities">Services and Utilities</a></li>
<li><a href="#%E9%83%A8%E7%BD%B2">部署</a></li>
</ul>
</li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->
<h2 id="Ember初探–Tutorial"><a href="#Ember初探–Tutorial" class="headerlink" title="Ember初探–Tutorial"></a>Ember初探–Tutorial</h2><h3 id="创建新的应用"><a href="#创建新的应用" class="headerlink" title="创建新的应用"></a>创建新的应用</h3><p>ember cli, ember命令行，都为ember项目提供了良好的项目结构，以及很多开发工具和附加的插件，因此使得使用ember的开发者们可以更加专心致力于App的开发而不是搭建项目的结构。</p>
<h4 id="初始化应用"><a href="#初始化应用" class="headerlink" title="初始化应用"></a>初始化应用</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 新建一个名为super-rentals的项目，我们将在应用里浏览并查找租房信息</span></div><div class="line">$ ember new super-rentals</div></pre></td></tr></table></figure>
<h4 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 基本的项目结构</span></div><div class="line">|--app <span class="comment"># models, components, routes, templates, styles...</span></div><div class="line">|--bower_components</div><div class="line">|--config <span class="comment"># containers environment.js</span></div><div class="line">|--dist <span class="comment"># output files</span></div><div class="line">|--node_modules</div><div class="line">|--public <span class="comment"># assets such as images &amp; fonts</span></div><div class="line">|--tests</div><div class="line">|--tmp <span class="comment"># ember cli temporary files</span></div><div class="line">|--vendor <span class="comment"># third-party dependencies</span></div><div class="line"></div><div class="line">bower.json</div><div class="line">ember-cli-build.js</div><div class="line">package.json</div><div class="line">README.md</div><div class="line">testem.js</div></pre></td></tr></table></figure>
<p>值得一提的是，ember cli默认使用es6语法</p>
<h4 id="start-server"><a href="#start-server" class="headerlink" title="start server"></a>start server</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ ember server</div><div class="line"><span class="comment"># $ ember s</span></div></pre></td></tr></table></figure>
<p>然后访问<a href="http://localhost:4200" target="_blank" rel="external">ember tutorial</a></p>
<h3 id="测试先行"><a href="#测试先行" class="headerlink" title="测试先行"></a>测试先行</h3><p>首先我们思考一下App的功能：</p>
<ul>
<li>列出可用的租房信息</li>
<li>要有能够到达公司介绍页面的链接</li>
<li>要有能够到达联系我们页面的链接</li>
<li>根据城市来筛选租房信息的列表</li>
</ul>
<p>它的最终形态应该这样：</p>
<p><img src="/images/ember_tutorial/style-super-rentals-maps.png" alt=""></p>
<p>我们把这些目标叫作<code>ember验收测试</code>，它用来保障我们的App在完工之后能够正常工作。</p>
<p>首先，新建一个测试文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ ember g acceptance-test list-rentals</div><div class="line"><span class="comment"># output</span></div><div class="line"><span class="comment"># installing acceptance-test</span></div><div class="line"><span class="comment">#   create tests/acceptance/list-rentals-test.js</span></div></pre></td></tr></table></figure>
<p>之后我们修改<code>/tests/acceptance/list-rentals-test.js</code>文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; test &#125; <span class="keyword">from</span> <span class="string">'qunit'</span>;</div><div class="line"><span class="keyword">import</span> moduleForAcceptance <span class="keyword">from</span> <span class="string">'super-rentals/tests/helpers/module-for-acceptance'</span>;</div><div class="line"></div><div class="line">moduleForAcceptance(<span class="string">'Acceptance | list-rentals'</span>);</div><div class="line"></div><div class="line">test(<span class="string">'should list available rentals.'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">assert</span>) </span>&#123;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">test(<span class="string">'should link to information about the company.'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">assert</span>) </span>&#123;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">test(<span class="string">'should link to contact information.'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">assert</span>) </span>&#123;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">test(<span class="string">'should filter the list of rentals by city.'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">assert</span>) </span>&#123;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>测试毫无疑问会爆掉。ember为我们提供了测试方法来模拟访问页面、表单填充、等待页面渲染等行为，因此我们应该更详细的写下测试：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 测试页面访问</span></div><div class="line">test(<span class="string">'should list available rentals.'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">assert</span>) </span>&#123;</div><div class="line">  visit(<span class="string">'/'</span>);</div><div class="line">  <span class="comment">// andThen 方法会等到之前的执行完毕之后再执行</span></div><div class="line">  andThen(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    assert.equal(find(<span class="string">'.listing'</span>).length, <span class="number">3</span>, <span class="string">'should see 3 listings'</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">test(<span class="string">'should link to information about the company.'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">assert</span>) </span>&#123;</div><div class="line">  visit(<span class="string">'/'</span>);</div><div class="line">  click(<span class="string">'a:contains("About")'</span>);</div><div class="line">  andThen(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    assert.equal(currentURL(), <span class="string">'/about'</span>, <span class="string">'should navigate to about'</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">test(<span class="string">'should link to contact information'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">assert</span>) </span>&#123;</div><div class="line">  visit(<span class="string">'/'</span>);</div><div class="line">  <span class="comment">// 运用click模拟点击操作</span></div><div class="line">  click(<span class="string">'a:contains("Contact")'</span>);</div><div class="line">  andThen(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    assert.equal(currentURL(), <span class="string">'/contact'</span>, <span class="string">'should navigate to contact'</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 最后来测试列表筛选功能</span></div><div class="line">test(<span class="string">'should filter the list of rentals by city.'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">assert</span>) </span>&#123;</div><div class="line">  visit(<span class="string">'/'</span>);</div><div class="line">  <span class="comment">// fillIn模拟input的填充</span></div><div class="line">  <span class="comment">// keyEvent模拟键盘事件</span></div><div class="line">  fillIn(<span class="string">'.list-filter input'</span>, <span class="string">'seattle'</span>);</div><div class="line">  keyEvent(<span class="string">'.list-filter input'</span>, <span class="string">'keyup'</span>, <span class="number">69</span>);</div><div class="line">  andThen(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    assert.equal(find(<span class="string">'.listing'</span>).length, <span class="number">1</span>, <span class="string">'should show 1 listing'</span>);</div><div class="line">    assert.equal(find(<span class="string">'.listing .location:contains("Seattle")'</span>).length, <span class="number">1</span>, <span class="string">'should contain 1 listing with location Seattle'</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="Routes-amp-Templates"><a href="#Routes-amp-Templates" class="headerlink" title="Routes &amp; Templates"></a>Routes &amp; Templates</h3><h4 id="新建about路由"><a href="#新建about路由" class="headerlink" title="新建about路由"></a>新建about路由</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">$ ember generate route about</div><div class="line"><span class="comment"># $ ember g route about</span></div><div class="line"></div><div class="line"><span class="comment"># 它会新增about路由，以及对应的route handler</span></div><div class="line"><span class="comment"># 并创建about模板，和对应的测试</span></div><div class="line"><span class="comment"># installing route</span></div><div class="line"><span class="comment">#   create app/routes/about.js</span></div><div class="line"><span class="comment">#   create app/templates/about.hbs</span></div><div class="line"><span class="comment"># updating router</span></div><div class="line"><span class="comment">#   add route about</span></div><div class="line"><span class="comment"># installing route-test</span></div><div class="line"><span class="comment">#   create tests/unit/routes/about-test.js</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// app/router.js</span></div><div class="line"><span class="keyword">import</span> Ember <span class="keyword">from</span> <span class="string">'ember'</span>;</div><div class="line"><span class="keyword">import</span> config <span class="keyword">from</span> <span class="string">'./config/environment'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Router = Ember.Router.extend(&#123;</div><div class="line">  <span class="attr">location</span>: config.locationType,</div><div class="line">  <span class="attr">rootURL</span>: config.rootURL</div><div class="line">&#125;);</div><div class="line"></div><div class="line">Router.map(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// 新增about</span></div><div class="line">  <span class="keyword">this</span>.route(<span class="string">'about'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> Router;</div></pre></td></tr></table></figure>
<p>在默认情况下，about路由指向<code>app/routes/about.js</code>route handler，并加载<code>app/templates/about.hbs</code>模板。来给模板里填充点东西：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"jumbo"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right tomster"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>About Super Rentals<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></div><div class="line">    The Super Rentals website is a delightful project created to explore Ember.</div><div class="line">    By building a property rental site, we can simultaneously imagine traveling</div><div class="line">    AND building Ember applications.</div><div class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="新建contact路由"><a href="#新建contact路由" class="headerlink" title="新建contact路由"></a>新建contact路由</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ember g route contact</div></pre></td></tr></table></figure>
<p>生成的文件结构和about一样。接着编写hbs</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- app/templates/contact.hbs --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"jumbo"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right tomster"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Contact Us<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Super Rentals Representatives would love to help you<span class="tag">&lt;<span class="name">br</span>&gt;</span>choose a destination or answer</div><div class="line">    any questions you may have.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></div><div class="line">    Super Rentals HQ</div><div class="line">    <span class="tag">&lt;<span class="name">address</span>&gt;</span></div><div class="line">      1212 Test Address Avenue<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">      Testington, OR 97233</div><div class="line">    <span class="tag">&lt;/<span class="name">address</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"tel:503.555.1212"</span>&gt;</span>+1 (503) 555-1212<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"mailto:superrentalsrep@emberjs.com"</span>&gt;</span>superrentalsrep@emberjs.com<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="使用-lt-￼51-gt-编写导航"><a href="#使用-lt-￼51-gt-编写导航" class="headerlink" title="使用{{link-to}}编写导航"></a>使用<code>{{link-to}}</code>编写导航</h4><p>ember拥有<code>{{link-to}}</code>这个内置的方法来构建不同路由的导航。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- app/templates/about.hbs --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"jumbo"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right tomster"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>About Super Rentals<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></div><div class="line">    The Super Rentals website is a delightful project created to explore Ember.</div><div class="line">    By building a property rental site, we can simultaneously imagine traveling</div><div class="line">    AND building Ember applications.</div><div class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  &#123;&#123;#link-to 'contact' class="button"&#125;&#125;</div><div class="line">    Get Started!</div><div class="line">  &#123;&#123;/link-to&#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>这是页面是这样的：<br><img src="/images/ember_tutorial/ember-super-rentals-about.png" alt=""></p>
<p>同样的，我们给contact页面也加上路由：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- app/templates/contact.hbs --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"jumbo"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right tomster"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Contact Us<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Super Rentals Representatives would love to help you<span class="tag">&lt;<span class="name">br</span>&gt;</span>choose a destination or answer</div><div class="line">    any questions you may have.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></div><div class="line">    Super Rentals HQ</div><div class="line">    <span class="tag">&lt;<span class="name">address</span>&gt;</span></div><div class="line">      1212 Test Address Avenue<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">      Testington, OR 97233</div><div class="line">    <span class="tag">&lt;/<span class="name">address</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"tel:503.555.1212"</span>&gt;</span>+1 (503) 555-1212<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"mailto:superrentalsrep@emberjs.com"</span>&gt;</span>superrentalsrep@emberjs.com<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  &#123;&#123;#link-to 'about' class="button"&#125;&#125;</div><div class="line">    About</div><div class="line">  &#123;&#123;/link-to&#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="增加首页"><a href="#增加首页" class="headerlink" title="增加首页"></a>增加首页</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ ember g route index</div><div class="line"></div><div class="line"><span class="comment"># installing route</span></div><div class="line"><span class="comment">#   create app/routes/index.js</span></div><div class="line"><span class="comment">#   create app/templates/index.hbs</span></div><div class="line"><span class="comment"># installing route-test</span></div><div class="line"><span class="comment">#   create tests/unit/routes/index-test.js</span></div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- app/templates/index.hbs --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"jumbo"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right tomster"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Welcome!<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></div><div class="line">    We hope you find exactly what you're looking for in a place to stay.</div><div class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span>Browse our listings, or use the search box above to narrow your search.</div><div class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  &#123;&#123;#link-to 'about' class="button"&#125;&#125;</div><div class="line">    About Us</div><div class="line">  &#123;&#123;/link-to&#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="各页面使用通用的导航栏"><a href="#各页面使用通用的导航栏" class="headerlink" title="各页面使用通用的导航栏"></a>各页面使用通用的导航栏</h4><p>为了能在不同的页面中渲染出一样的结构和样式，我们需要创建一个<code>application</code>模板</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ ember g template application</div><div class="line"></div><div class="line"><span class="comment"># installing template</span></div><div class="line"><span class="comment">#   create app/templates/application.hbs</span></div></pre></td></tr></table></figure>
<p>当<code>application.hbs</code>创建好之后，每个页面都会渲染它：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- app/templates/application.hbs --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"menu"</span>&gt;</span></div><div class="line">    &#123;&#123;#link-to 'index'&#125;&#125;</div><div class="line">      <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">em</span>&gt;</span>SuperRentals<span class="tag">&lt;/<span class="name">em</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">    &#123;&#123;/link-to&#125;&#125;</div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left links"</span>&gt;</span></div><div class="line">      &#123;&#123;#link-to 'about'&#125;&#125;</div><div class="line">        About</div><div class="line">      &#123;&#123;/link-to&#125;&#125;</div><div class="line">      &#123;&#123;#link-to 'contact'&#125;&#125;</div><div class="line">        Contact</div><div class="line">      &#123;&#123;/link-to&#125;&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"body"</span>&gt;</span></div><div class="line">    &#123;&#123;outlet&#125;&#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>需要注意的是，<code>{{outlet}}</code>是各页面将对应route handler渲染的template组合进<code>application</code>的位置。</p>
</blockquote>
<h3 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h3><p>接下来，我们要在首页增加一个列表，为此，需要一个租房信息的model来储存数据。但一步一步来嘛，我们先hard-code写一个JavaScript Object进去：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// app/routes/index.js</span></div><div class="line"><span class="comment">// 在index的route handler中写入加数据</span></div><div class="line"><span class="keyword">import</span> Ember <span class="keyword">from</span> <span class="string">'ember'</span>;</div><div class="line"></div><div class="line"><span class="keyword">let</span> rentals = [&#123;</div><div class="line">  <span class="attr">id</span>: <span class="number">1</span>,</div><div class="line">  <span class="attr">title</span>: <span class="string">'Grand Old Mansion'</span>,</div><div class="line">  <span class="attr">owner</span>: <span class="string">'Veruca Salt'</span>,</div><div class="line">  <span class="attr">city</span>: <span class="string">'San Francisco'</span>,</div><div class="line">  <span class="attr">type</span>: <span class="string">'Estate'</span>,</div><div class="line">  <span class="attr">bedrooms</span>: <span class="number">15</span>,</div><div class="line">  <span class="attr">image</span>: <span class="string">'https://upload.wikimedia.org/wikipedia/commons/c/cb/Crane_estate_(5).jpg'</span></div><div class="line">&#125;, &#123;</div><div class="line">  <span class="attr">id</span>: <span class="number">2</span>,</div><div class="line">  <span class="attr">title</span>: <span class="string">'Urban Living'</span>,</div><div class="line">  <span class="attr">owner</span>: <span class="string">'Mike TV'</span>,</div><div class="line">  <span class="attr">city</span>: <span class="string">'Seattle'</span>,</div><div class="line">  <span class="attr">type</span>: <span class="string">'Condo'</span>,</div><div class="line">  <span class="attr">bedrooms</span>: <span class="number">1</span>,</div><div class="line">  <span class="attr">image</span>: <span class="string">'https://upload.wikimedia.org/wikipedia/commons/0/0e/Alfonso_13_Highrise_Tegucigalpa.jpg'</span></div><div class="line">&#125;, &#123;</div><div class="line">  <span class="attr">id</span>: <span class="number">3</span>,</div><div class="line">  <span class="attr">title</span>: <span class="string">'Downtown Charm'</span>,</div><div class="line">  <span class="attr">owner</span>: <span class="string">'Violet Beauregarde'</span>,</div><div class="line">  <span class="attr">city</span>: <span class="string">'Portland'</span>,</div><div class="line">  <span class="attr">type</span>: <span class="string">'Apartment'</span>,</div><div class="line">  <span class="attr">bedrooms</span>: <span class="number">3</span>,</div><div class="line">  <span class="attr">image</span>: <span class="string">'https://upload.wikimedia.org/wikipedia/commons/f/f7/Wheeldon_Apartment_Building_-_Portland_Oregon.jpg'</span></div><div class="line">&#125;];</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> Ember.Route.extend(&#123;</div><div class="line">  <span class="comment">// model()等效于model: function()</span></div><div class="line">  model() &#123;</div><div class="line">    <span class="keyword">return</span> rentals;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>之后当用户进入<code>index</code>页面的时候就会调用model钩子，并返回我们虚构的数据。紧接着，就会把数据渲染在模板上：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- app/templates/index.hbs --&gt;</span></div><div class="line"><span class="comment">&lt;!-- 忽略 --&gt;</span></div><div class="line"></div><div class="line">&#123;&#123;#each model as |rental|&#125;&#125;</div><div class="line">  <span class="tag">&lt;<span class="name">article</span> <span class="attr">class</span>=<span class="string">"listing"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123;rental.title&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"detail owner"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>Owner:<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;&#123;rental.owner&#125;&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"detail type"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>Type:<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;&#123;rental.type&#125;&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"detail location"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>Location:<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;&#123;rental.city&#125;&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"detail bedrooms"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>Number of bedrooms:<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;&#123;rental.bedrooms&#125;&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">article</span>&gt;</span></div><div class="line">&#123;&#123;/each&#125;&#125;</div></pre></td></tr></table></figure>
<p>在模板里，我们通过<code>{{#each}} {{\each}}</code>进行循环遍历。最终的页面应该长这样：</p>
<p><img src="/images/ember_tutorial/super-rentals-index-with-list.png" alt=""></p>
<h3 id="安装附加插件"><a href="#安装附加插件" class="headerlink" title="安装附加插件"></a>安装附加插件</h3><p>ember提供了非常多的附加插件，你可以在<a href="https://emberobserver.com/" target="_blank" rel="external">Ember Observer</a>查阅它们。</p>
<p>在这个项目里我们会使用两个插件：<a href="https://github.com/toddjordan/ember-cli-tutorial-style" target="_blank" rel="external">ember-cli-tutorial-style</a>和<a href="http://www.ember-cli-mirage.com/" target="_blank" rel="external">ember-cli-mirage</a></p>
<h4 id="ember-cli-tutorial-style"><a href="#ember-cli-tutorial-style" class="headerlink" title="ember-cli-tutorial-style"></a>ember-cli-tutorial-style</h4><p>为了避免你写繁琐的CSS代码，继续跟着这个ember教程走，就要安装<code>ember-cli-tutorial-style</code>来为这个项目提供CSS样式。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ ember install ember-cli-tutorial-style</div><div class="line"><span class="comment"># 安装完成之后重启ember server</span></div></pre></td></tr></table></figure>
<p>这个插件安装完后生成<code>vendor/ember-tutorial.css</code>文件。当ember cli运行时，它会被打包进<code>vendor.css</code>文件里，最终被<code>index.html</code>页面所引用。</p>
<p>效果如下：</p>
<p><img src="/images/ember_tutorial/styled-super-rentals-basic.png" alt=""></p>
<h4 id="ember-cli-mirage"><a href="#ember-cli-mirage" class="headerlink" title="ember-cli-mirage"></a>ember-cli-mirage</h4><p><a href="http://www.ember-cli-mirage.com/" target="_blank" rel="external">Mirage</a>是一个<a href="http://kaverjody.com/chinese-terms-fake-mock-stub-driver-simulator-dummy-double/" target="_blank" rel="external">静态HTTP桩库</a>，常用于ember的验收测试。我们在这里将它作为模拟的数据源。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ ember install ember-cli-mirage</div><div class="line"><span class="comment"># 安装完成之后需要重启ember server</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 更新/mirage/config.js</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.get(<span class="string">'/rentals'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">data</span>: [&#123;</div><div class="line">        <span class="attr">type</span>: <span class="string">'rentals'</span>,</div><div class="line">        <span class="attr">id</span>: <span class="number">1</span>,</div><div class="line">        <span class="attr">attributes</span>: &#123;</div><div class="line">          <span class="attr">title</span>: <span class="string">'Grand Old Mansion'</span>,</div><div class="line">          <span class="attr">owner</span>: <span class="string">'Veruca Salt'</span>,</div><div class="line">          <span class="attr">city</span>: <span class="string">'San Francisco'</span>,</div><div class="line">          <span class="attr">type</span>: <span class="string">'Estate'</span>,</div><div class="line">          <span class="attr">bedrooms</span>: <span class="number">15</span>,</div><div class="line">          <span class="attr">image</span>: <span class="string">'https://upload.wikimedia.org/wikipedia/commons/c/cb/Crane_estate_(5).jpg'</span></div><div class="line">        &#125;</div><div class="line">      &#125;, &#123;</div><div class="line">        <span class="attr">type</span>: <span class="string">'rentals'</span>,</div><div class="line">        <span class="attr">id</span>: <span class="number">2</span>,</div><div class="line">        <span class="attr">attributes</span>: &#123;</div><div class="line">          <span class="attr">title</span>: <span class="string">'Urban Living'</span>,</div><div class="line">          <span class="attr">owner</span>: <span class="string">'Mike Teavee'</span>,</div><div class="line">          <span class="attr">city</span>: <span class="string">'Seattle'</span>,</div><div class="line">          <span class="attr">type</span>: <span class="string">'Condo'</span>,</div><div class="line">          <span class="attr">bedrooms</span>: <span class="number">1</span>,</div><div class="line">          <span class="attr">image</span>: <span class="string">'https://upload.wikimedia.org/wikipedia/commons/0/0e/Alfonso_13_Highrise_Tegucigalpa.jpg'</span></div><div class="line">        &#125;</div><div class="line">      &#125;, &#123;</div><div class="line">        <span class="attr">type</span>: <span class="string">'rentals'</span>,</div><div class="line">        <span class="attr">id</span>: <span class="number">3</span>,</div><div class="line">        <span class="attr">attributes</span>: &#123;</div><div class="line">          <span class="attr">title</span>: <span class="string">'Downtown Charm'</span>,</div><div class="line">          <span class="attr">owner</span>: <span class="string">'Violet Beauregarde'</span>,</div><div class="line">          <span class="attr">city</span>: <span class="string">'Portland'</span>,</div><div class="line">          <span class="attr">type</span>: <span class="string">'Apartment'</span>,</div><div class="line">          <span class="attr">bedrooms</span>: <span class="number">3</span>,</div><div class="line">          <span class="attr">image</span>: <span class="string">'https://upload.wikimedia.org/wikipedia/commons/f/f7/Wheeldon_Apartment_Building_-_Portland_Oregon.jpg'</span></div><div class="line">        &#125;</div><div class="line">      &#125;]</div><div class="line">    &#125;;</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这样就模拟了当发送GET请求给<code>/rentals</code>时，返回的JSON数据。</p>
<h3 id="使用Ember-Data"><a href="#使用Ember-Data" class="headerlink" title="使用Ember Data"></a>使用Ember Data</h3><p>到目前为止，这个APP里的数据都是我们hard-code出来的。当应用不断增大时，我们可能会有新的需求，例如增加/更新/删除数据等等。ember提供了一个数据管理库（Ember Data）来处理这个问题。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 创建名为rental的ember data model</span></div><div class="line">$ ember g model rental</div><div class="line"></div><div class="line"><span class="comment"># installing model</span></div><div class="line"><span class="comment">#   create app/models/rental.js</span></div><div class="line"><span class="comment"># installing model-test</span></div><div class="line"><span class="comment">#   create tests/unit/models/rental-test.js</span></div></pre></td></tr></table></figure>
<p>打开<code>app/models/rental.js</code>，发现里面长这样：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// app/models/rental.js</span></div><div class="line"><span class="keyword">import</span> DS <span class="keyword">from</span> <span class="string">'ember-data'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> DS.Model.extend(&#123;</div><div class="line"></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>把title, owner, city, type, image, and bedrooms作为支持的属性写进去：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// app/models/rental.js</span></div><div class="line"><span class="keyword">import</span> DS <span class="keyword">from</span> <span class="string">'ember-data'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> DS.Model.extend(&#123;</div><div class="line">  <span class="attr">title</span>: DS.attr(),</div><div class="line">  <span class="attr">owner</span>: DS.attr(),</div><div class="line">  <span class="attr">city</span>: DS.attr(),</div><div class="line">  <span class="attr">type</span>: DS.attr(),</div><div class="line">  <span class="attr">image</span>: DS.attr(),</div><div class="line">  <span class="attr">bedrooms</span>: DS.attr()</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="更新Model-Hook（route-handler）"><a href="#更新Model-Hook（route-handler）" class="headerlink" title="更新Model Hook（route handler）"></a>更新Model Hook（route handler）</h4><p>此时已经没必要保留hard-code进index route-handler里的数据了：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// app/routes/index.js</span></div><div class="line"><span class="keyword">import</span> Ember <span class="keyword">from</span> <span class="string">'ember'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> Ember.Route.extend(&#123;</div><div class="line">  model() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.get(<span class="string">'store'</span>).findAll(<span class="string">'rental'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>当我们调用<code>this.get(&#39;store&#39;).findAll(&#39;rental&#39;)</code>的时候，Ember Data会发送一个GET请求到<code>/rentals</code>。</p>
<p>当我们在开发环境下使用<code>Mirage</code>的时候，获得的数据都是我们自己提供给<code>Mirage</code>的。而到了生产环境下，则需要为Ember Data提供后端数据接口。</p>
<h3 id="建立简单的组件"><a href="#建立简单的组件" class="headerlink" title="建立简单的组件"></a>建立简单的组件</h3><p>当用户访问我们的列表时，可能想要一些可交互的操作来帮助他们更好的浏览和决策。为了高效的达成这个目的，应该建立一个组件把我们的列表独立出去。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 新建名为rental-listing的组件</span></div><div class="line">$ ember g component rental-listing</div><div class="line"></div><div class="line"><span class="comment"># installing component</span></div><div class="line"><span class="comment">#   create app/components/rental-listing.js</span></div><div class="line"><span class="comment">#   create app/templates/components/rental-listing.hbs</span></div><div class="line"><span class="comment"># installing component-test</span></div><div class="line"><span class="comment">#   create tests/integration/components/rental-listing-test.js</span></div></pre></td></tr></table></figure>
<blockquote>
<p>要注意的是。<code>-</code>在组件名里必不可缺，它用来方式组件名和HTML元素名发生冲突。因此<code>rental-listing</code>这个名字ok而<code>rental</code>不行。</p>
</blockquote>
<p>下一步，测试先行：</p>
<p>我们期望在组件render的时候没有<code>wide</code>这个class名，而点击<code>.image</code>的时候则可以切换<code>wide</code>class。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; moduleForComponent, test &#125; <span class="keyword">from</span> <span class="string">'ember-qunit'</span>;</div><div class="line"><span class="keyword">import</span> hbs <span class="keyword">from</span> <span class="string">'htmlbars-inline-precompile'</span>;</div><div class="line"><span class="keyword">import</span> Ember <span class="keyword">from</span> <span class="string">'ember'</span>;</div><div class="line"></div><div class="line">moduleForComponent(<span class="string">'rental-listing'</span>, <span class="string">'Integration | Component | rental listing'</span>, &#123;</div><div class="line">  <span class="attr">integration</span>: <span class="literal">true</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">test(<span class="string">'should toggle wide class on click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">assert</span>) </span>&#123;</div><div class="line">  assert.expect(<span class="number">3</span>);</div><div class="line">  <span class="keyword">let</span> stubRental = Ember.Object.create(&#123;</div><div class="line">    <span class="attr">image</span>: <span class="string">'fake.png'</span>,</div><div class="line">    <span class="attr">title</span>: <span class="string">'test-title'</span>,</div><div class="line">    <span class="attr">owner</span>: <span class="string">'test-owner'</span>,</div><div class="line">    <span class="attr">type</span>: <span class="string">'test-type'</span>,</div><div class="line">    <span class="attr">city</span>: <span class="string">'test-city'</span>,</div><div class="line">    <span class="attr">bedrooms</span>: <span class="number">3</span></div><div class="line">  &#125;);</div><div class="line">  <span class="keyword">this</span>.set(<span class="string">'rentalObj'</span>, stubRental);</div><div class="line">  <span class="keyword">this</span>.render(hbs<span class="string">`&#123;% raw %&#125;&#123;&#123;rental-listing rental=rentalObj&#125;&#125;&#123;% endraw %&#125;`</span>);</div><div class="line">  assert.equal(<span class="keyword">this</span>.$(<span class="string">'.image.wide'</span>).length, <span class="number">0</span>, <span class="string">'initially rendered small'</span>);</div><div class="line">  <span class="keyword">this</span>.$(<span class="string">'.image'</span>).click();</div><div class="line">  assert.equal(<span class="keyword">this</span>.$(<span class="string">'.image.wide'</span>).length, <span class="number">1</span>, <span class="string">'rendered wide after click'</span>);</div><div class="line">  <span class="keyword">this</span>.$(<span class="string">'.image'</span>).click();</div><div class="line">  assert.equal(<span class="keyword">this</span>.$(<span class="string">'.image.wide'</span>).length, <span class="number">0</span>, <span class="string">'rendered small after second click'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<blockquote>
<p>值得注意的是，在测试中使用了jQuery选择器来获取目标元素。</p>
</blockquote>
<h4 id="组件的组成"><a href="#组件的组成" class="headerlink" title="组件的组成"></a>组件的组成</h4><p>组件由两部分组成（除去组件对应的测试文件）：</p>
<ul>
<li>模板文件来决定组件的样式（<code>app/templates/components/rental-listing.hbs</code>）</li>
<li>js文件来决定组件的行为（<code>app/components/rental-listing.js</code>）</li>
</ul>
<p>我们把之前<code>app/templates/index.hbs</code>里的列表元素转移到<code>app/templates/components/rental-listing.hbs</code>里，并新增<code>img</code>标签：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- app/templates/components/rental-listing.hbs --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">article</span> <span class="attr">class</span>=<span class="string">"listing"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;&#123;rental.image&#125;&#125;"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123;rental.title&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"detail owner"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>Owner:<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;&#123;rental.owner&#125;&#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"detail type"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>Type:<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;&#123;rental.type&#125;&#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"detail location"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>Location:<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;&#123;rental.city&#125;&#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"detail bedrooms"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>Number of bedrooms:<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;&#123;rental.bedrooms&#125;&#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">article</span>&gt;</span></div></pre></td></tr></table></figure>
<p>而在<code>app/templates/index.hbs</code>文件中，使用一个循环来替代之前的列表：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- app/templates/index.hbs --&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 忽略 --&gt;</span></div><div class="line"></div><div class="line">&#123;&#123;#each model as |rentalUnit|&#125;&#125;</div><div class="line">  &#123;&#123;rental-listing rental=rentalUnit&#125;&#125;</div><div class="line">&#123;&#123;/each&#125;&#125;</div></pre></td></tr></table></figure>
<p>在<code>index.hbs</code>里，通过<code>rental-listing</code>这个名词来引用对应的组件，并将数据遍历中的每组数据命名为<code>rentalUnit</code>传递给<code>rental-listing.hbs</code>组件。</p>
<h4 id="放大-缩小图片"><a href="#放大-缩小图片" class="headerlink" title="放大/缩小图片"></a>放大/缩小图片</h4><p>现在我们来处理用户对图片的点击事件。</p>
<p>首先，需要使用<code>{{#if}}</code>这个辅助方法来确定是否要把<code>wide</code>class名赋给对应的标签：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- app/templates/components/rental-listing.hbs --&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 忽略 --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"image &#123;&#123;if isWide "</span><span class="attr">wide</span>"&#125;&#125;"&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;&#123;rental.image&#125;&#125;"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">small</span>&gt;</span>View Larger<span class="tag">&lt;/<span class="name">small</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 忽略 --&gt;</span></div></pre></td></tr></table></figure>
<p>其中，<code>isWide</code>这个值来源自组件的js文件。鉴于我们期望组件在初次渲染时只是小图，可以在js里把<code>isWide</code>赋值为<code>false</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// app/components/rental-listing.js</span></div><div class="line"><span class="keyword">import</span> Ember <span class="keyword">from</span> <span class="string">'ember'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> Ember.Component.extend(&#123;</div><div class="line">  <span class="attr">isWide</span>: <span class="literal">false</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>接下来就是事件的绑定。为了让用户可以切换<code>isWide</code>的值，我们需要在标签上绑定点击事件：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- app/templates/components/rental-listing.hbs --&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 忽略 --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">a</span> &#123;&#123;<span class="attr">action</span> '<span class="attr">toggleImageSize</span>'&#125;&#125; <span class="attr">class</span>=<span class="string">"image &#123;&#123;if isWide "</span><span class="attr">wide</span>"&#125;&#125;"&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;&#123;rental.image&#125;&#125;"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">small</span>&gt;</span>View Larger<span class="tag">&lt;/<span class="name">small</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 忽略 --&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// app/components/rental-listing.js</span></div><div class="line"><span class="keyword">import</span> Ember <span class="keyword">from</span> <span class="string">'ember'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> Ember.Component.extend(&#123;</div><div class="line">  <span class="attr">isWide</span>: <span class="literal">false</span>,</div><div class="line">  <span class="attr">actions</span>: &#123;</div><div class="line">    toggleImageSize() &#123;</div><div class="line">      <span class="keyword">this</span>.toggleProperty(<span class="string">'isWide'</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>当点击a标签的时候，会给组件的js文件发送这个action，组件接受这个action，触发对应的事件（<code>toggleImageSize</code>），最终调用<code>toggleProperty</code>方法切换<code>isWide</code>属性。</p>
<p>最终当我们点击图片的时候，效果如图：</p>
<p><img src="/images/ember_tutorial/styled-rental-listings.png" alt=""></p>
<h3 id="建立Handlebars-Helper"><a href="#建立Handlebars-Helper" class="headerlink" title="建立Handlebars Helper"></a>建立Handlebars Helper</h3><p>目前为止，App渲染的数据都是从Ember Data里直接取出的。如果我们的应用增长的很大有很多数据，想要在渲染时改变一些数据的话，就要借助<code>Handlebars Helper</code>，在hbs文件中对数据进行修饰。</p>
<p>现在来建立一个Handlebars Helper，帮助用户快速的分辨列表中的各条目是”Standalone”还是”Community”。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ ember g helper rental-property-type</div><div class="line"></div><div class="line"><span class="comment"># installing helper</span></div><div class="line"><span class="comment">#   create app/helpers/rental-property-type.js</span></div><div class="line"><span class="comment"># installing helper-test</span></div><div class="line"><span class="comment">#   create tests/unit/helpers/rental-property-type-test.js</span></div></pre></td></tr></table></figure>
<p>初始化的helper，从hbs中引用并接受参数，然后返回这个参数。</p>
<p>需要注意的是，<code>rentalPropertyType</code>的参数<code>params</code>是个Array</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// app/helpers/rental-property-type.js</span></div><div class="line"><span class="keyword">import</span> Ember <span class="keyword">from</span> <span class="string">'ember'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">rentalPropertyType</span>(<span class="params">params<span class="regexp">/*, hash*/</span></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> params;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> Ember.Helper.helper(rentalPropertyType);</div></pre></td></tr></table></figure>
<p>更新<code>rental-listing.hbs</code>文件：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- app/templates/components/rental-listing.hbs --&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 忽略 --&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 替换了 &#123;&#123;rental.type&#125;&#125; --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"detail type"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>Type:<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;&#123;rental-property-type rental.type&#125;&#125; - &#123;&#123;rental.type&#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 忽略 --&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p><code>rental-property-type</code>后可跟多个参数，因此实际传入的参数会被转换为一个Array</p>
</blockquote>
<p>然后更新<code>rental-property-type.js</code>文件，让它对<code>rental.type</code>进行判断，返回不同的值：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// app/helpers/rental-property-type.js</span></div><div class="line"><span class="keyword">import</span> Ember <span class="keyword">from</span> <span class="string">'ember'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> communityPropertyTypes = [</div><div class="line">  <span class="string">'Condo'</span>,</div><div class="line">  <span class="string">'Townhouse'</span>,</div><div class="line">  <span class="string">'Apartment'</span></div><div class="line">];</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">rentalPropertyType</span>(<span class="params">[type]<span class="regexp">/*, hash*/</span></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (communityPropertyTypes.contains(type)) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'Community'</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="string">'Standalone'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> Ember.Helper.helper(rentalPropertyType);</div></pre></td></tr></table></figure>
<p>因为<code>Handlebars Helper</code>会把参数转为Array，所以我们在<code>rentalPropertyType</code>中通过<code>[type]</code>来获取第一个参数，也就是我们传进去的<code>rental.type</code>。</p>
<p>刷新页面，可以看见列表的前两个是Standalone，其他的是Community</p>
<h3 id="建立复杂组件"><a href="#建立复杂组件" class="headerlink" title="建立复杂组件"></a>建立复杂组件</h3><p>基础功能完成了，我们接下来给App增加筛选功能，为此需要新建一个名为<code>list-filter</code>的组件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ ember g component list-filter</div><div class="line"></div><div class="line"><span class="comment"># installing component</span></div><div class="line"><span class="comment">#   create app/components/list-filter.js</span></div><div class="line"><span class="comment">#   create app/templates/components/list-filter.hbs</span></div><div class="line"><span class="comment"># installing component-test</span></div><div class="line"><span class="comment">#   create tests/integration/components/list-filter-test.js</span></div></pre></td></tr></table></figure>
<p>像之前那样，测试先行，以便帮助我们更好的思考自己要做的事情：</p>
<ul>
<li>filter component应该能够渲染出一个筛选后的列表</li>
<li>当没有筛选的时候它应该渲染全部的列表</li>
<li>有的话则渲染根据城市筛选出的列表</li>
</ul>
<p>在初步测试里，我们只要简单的验证所有的城市都被渲染并可得就可以了。因为使用了Ember Data作为数据储存，我们需要异步的拿取数据，并使用<code>wait</code>方法等待所有的异步完成。（异步返回promise）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// tests/integration/components/list-filter-test.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; moduleForComponent, test &#125; <span class="keyword">from</span> <span class="string">'ember-qunit'</span>;</div><div class="line"><span class="keyword">import</span> hbs <span class="keyword">from</span> <span class="string">'htmlbars-inline-precompile'</span>;</div><div class="line"><span class="keyword">import</span> wait <span class="keyword">from</span> <span class="string">'ember-test-helpers/wait'</span>;</div><div class="line"><span class="keyword">import</span> RSVP <span class="keyword">from</span> <span class="string">'rsvp'</span>;</div><div class="line"></div><div class="line">moduleForComponent(<span class="string">'list-filter'</span>, <span class="string">'Integration | Component | filter listing'</span>, &#123;</div><div class="line">  <span class="attr">integration</span>: <span class="literal">true</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">const</span> ITEMS = [&#123;<span class="attr">city</span>: <span class="string">'San Francisco'</span>&#125;, &#123;<span class="attr">city</span>: <span class="string">'Portland'</span>&#125;, &#123;<span class="attr">city</span>: <span class="string">'Seattle'</span>&#125;];</div><div class="line"><span class="keyword">const</span> FILTERED_ITEMS = [&#123;<span class="attr">city</span>: <span class="string">'San Francisco'</span>&#125;];</div><div class="line"></div><div class="line">test(<span class="string">'should initially load all listings'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">assert</span>) </span>&#123;</div><div class="line">  <span class="comment">// action异步获取数据并返回promise</span></div><div class="line">  <span class="keyword">this</span>.on(<span class="string">'filterByCity'</span>, (val) =&gt; &#123;</div><div class="line">    <span class="keyword">if</span> (val === <span class="string">''</span>) &#123;</div><div class="line">      <span class="keyword">return</span> RSVP.resolve(ITEMS);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> RSVP.resolve(FILTERED_ITEMS);</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  <span class="comment">// 你可以像hbs里那样使用你的组件，来模拟组件的渲染</span></div><div class="line">  <span class="keyword">this</span>.render(hbs<span class="string">`</span></div><div class="line">    &#123;&#123;#list-filter filter=(action 'filterByCity') as |results|&#125;&#125;</div><div class="line">      &lt;ul&gt;</div><div class="line">      &#123;&#123;#each results as |item|&#125;&#125;</div><div class="line">        &lt;li class="city"&gt;</div><div class="line">          &#123;&#123;item.city&#125;&#125;</div><div class="line">        &lt;/li&gt;</div><div class="line">      &#123;&#123;/each&#125;&#125;</div><div class="line">      &lt;/ul&gt;</div><div class="line">    &#123;&#123;/list-filter&#125;&#125;</div><div class="line">  `);</div><div class="line"></div><div class="line">  <span class="comment">// wait function会等待所有的promise和xhr请求结束，并返回一个promise</span></div><div class="line">  <span class="keyword">return</span> wait().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    assert.equal(<span class="keyword">this</span>.$(<span class="string">'.city'</span>).length, <span class="number">3</span>);</div><div class="line">    assert.equal(<span class="keyword">this</span>.$(<span class="string">'.city'</span>).first().text().trim(), <span class="string">'San Francisco'</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>下一步，我们要在输入框中输入一些文字，监听键盘keyup事件并调用filter action，而且期待列表被筛选后只有一个条目被render：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// tests/integration/components/list-filter-test.js</span></div><div class="line"></div><div class="line"><span class="comment">// 忽略</span></div><div class="line"></div><div class="line">test(<span class="string">'should update with matching listings'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">assert</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.on(<span class="string">'filterByCity'</span>, (val) =&gt; &#123;</div><div class="line">    <span class="keyword">if</span> (val === <span class="string">''</span>) &#123;</div><div class="line">      <span class="keyword">return</span> RSVP.resolve(ITEMS);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> RSVP.resolve(FILTERED_ITEMS);</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  <span class="keyword">this</span>.render(hbs<span class="string">`</span></div><div class="line">    &#123;&#123;#list-filter filter=(action 'filterByCity') as |results|&#125;&#125;</div><div class="line">      &lt;ul&gt;</div><div class="line">      &#123;&#123;#each results as |item|&#125;&#125;</div><div class="line">        &lt;li class="city"&gt;</div><div class="line">          &#123;&#123;item.city&#125;&#125;</div><div class="line">        &lt;/li&gt;</div><div class="line">      &#123;&#123;/each&#125;&#125;</div><div class="line">      &lt;/ul&gt;</div><div class="line">    &#123;&#123;/list-filter&#125;&#125;</div><div class="line">  `);</div><div class="line"></div><div class="line">  <span class="comment">// keyup 事件应该触发列表被筛选的事件</span></div><div class="line">  <span class="keyword">this</span>.$(<span class="string">'.list-filter input'</span>).val(<span class="string">'San'</span>).keyup();</div><div class="line"></div><div class="line">  <span class="keyword">return</span> wait().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    assert.equal(<span class="keyword">this</span>.$(<span class="string">'.city'</span>).length, <span class="number">1</span>);</div><div class="line">    assert.equal(<span class="keyword">this</span>.$(<span class="string">'.city'</span>).text().trim(), <span class="string">'San Francisco'</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>之后处理模板。我们在<code>app/templates/index.hbs</code>中要像测试里写的那样调用组价：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- app/templates/index.hbs --&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 上面的忽略 --&gt;</span></div><div class="line"></div><div class="line">&#123;&#123;#list-filter</div><div class="line">   filter=(action 'filterByCity')</div><div class="line">   as |rentals|&#125;&#125;</div><div class="line">  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"results"</span>&gt;</span></div><div class="line">    &#123;&#123;#each rentals as |rentalUnit|&#125;&#125;</div><div class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;&#123;rental-listing rental=rentalUnit&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    &#123;&#123;/each&#125;&#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line">&#123;&#123;/list-filter&#125;&#125;</div></pre></td></tr></table></figure>
<p>并且在<code>list-filter.hbs</code>中增加input：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- app/templates/components/list-filter.hbs --&gt;</span></div><div class="line">&#123;&#123;input value=value key-up=(action 'handleFilterEntry') class="light" placeholder="Filter By City"&#125;&#125;</div><div class="line">&#123;&#123;yield results&#125;&#125;</div></pre></td></tr></table></figure>
<p>在这里我们使用了<code>{{input}}</code> helper来render一个input，而input的<code>value</code>和<code>key-up</code>事件都由这个component对应的js提供：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// app/components/list-filter.js</span></div><div class="line"><span class="keyword">import</span> Ember <span class="keyword">from</span> <span class="string">'ember'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> Ember.Component.extend(&#123;</div><div class="line">  <span class="attr">classNames</span>: [<span class="string">'list-filter'</span>],</div><div class="line">  <span class="attr">value</span>: <span class="string">''</span>,</div><div class="line"></div><div class="line">  init() &#123;</div><div class="line">    <span class="keyword">this</span>._super(...arguments);</div><div class="line">    <span class="comment">// 初始化</span></div><div class="line">    <span class="keyword">this</span>.get(<span class="string">'filter'</span>)(<span class="string">''</span>).then(<span class="function">(<span class="params">results</span>) =&gt;</span> <span class="keyword">this</span>.set(<span class="string">'results'</span>, results));</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">actions</span>: &#123;</div><div class="line">    handleFilterEntry() &#123;</div><div class="line">      <span class="keyword">let</span> filterInputValue = <span class="keyword">this</span>.get(<span class="string">'value'</span>); <span class="comment">// input的value</span></div><div class="line">      <span class="keyword">let</span> filterAction = <span class="keyword">this</span>.get(<span class="string">'filter'</span>); <span class="comment">// 在index.hbs中传入，为filterByCity</span></div><div class="line">      <span class="comment">// 筛选过后把结果赋值给result</span></div><div class="line">      <span class="comment">// filter=(action 'filterByCity') as |rentals| 即 result as |rentals|</span></div><div class="line">      filterAction(filterInputValue).then(<span class="function">(<span class="params">filterResults</span>) =&gt;</span> <span class="keyword">this</span>.set(<span class="string">'results'</span>, filterResults));</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>现在我们需要一个controller，来运行筛选的方法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ember g controller index</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// app/controllers/index.js</span></div><div class="line"><span class="keyword">import</span> Ember <span class="keyword">from</span> <span class="string">'ember'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> Ember.Controller.extend(&#123;</div><div class="line">  <span class="attr">actions</span>: &#123;</div><div class="line">    filterByCity(param) &#123;</div><div class="line">      <span class="keyword">if</span> (param !== <span class="string">''</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.get(<span class="string">'store'</span>).query(<span class="string">'rental'</span>, &#123; <span class="attr">city</span>: param &#125;);</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.get(<span class="string">'store'</span>).findAll(<span class="string">'rental'</span>);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>当用户在搜索框敲入字符的时候，就会调用filterByCity方法。该方法根据传入参数的不同调用不同的查询语句来达到搜索的效果。所以我们还需要修改之前的那个<code>mirage/config.js</code>文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// mirage/config.js</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.get(<span class="string">'/rentals'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">db, request</span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> rentals = [&#123;</div><div class="line">        <span class="attr">type</span>: <span class="string">'rentals'</span>,</div><div class="line">        <span class="attr">id</span>: <span class="number">1</span>,</div><div class="line">        <span class="attr">attributes</span>: &#123;</div><div class="line">          <span class="attr">title</span>: <span class="string">'Grand Old Mansion'</span>,</div><div class="line">          <span class="attr">owner</span>: <span class="string">'Veruca Salt'</span>,</div><div class="line">          <span class="attr">city</span>: <span class="string">'San Francisco'</span>,</div><div class="line">          <span class="attr">type</span>: <span class="string">'Estate'</span>,</div><div class="line">          <span class="attr">bedrooms</span>: <span class="number">15</span>,</div><div class="line">          <span class="attr">image</span>: <span class="string">'https://upload.wikimedia.org/wikipedia/commons/c/cb/Crane_estate_(5).jpg'</span></div><div class="line">        &#125;</div><div class="line">      &#125;, &#123;</div><div class="line">        <span class="attr">type</span>: <span class="string">'rentals'</span>,</div><div class="line">        <span class="attr">id</span>: <span class="number">2</span>,</div><div class="line">        <span class="attr">attributes</span>: &#123;</div><div class="line">          <span class="attr">title</span>: <span class="string">'Urban Living'</span>,</div><div class="line">          <span class="attr">owner</span>: <span class="string">'Mike Teavee'</span>,</div><div class="line">          <span class="attr">city</span>: <span class="string">'Seattle'</span>,</div><div class="line">          <span class="attr">type</span>: <span class="string">'Condo'</span>,</div><div class="line">          <span class="attr">bedrooms</span>: <span class="number">1</span>,</div><div class="line">          <span class="attr">image</span>: <span class="string">'https://upload.wikimedia.org/wikipedia/commons/0/0e/Alfonso_13_Highrise_Tegucigalpa.jpg'</span></div><div class="line">        &#125;</div><div class="line">      &#125;, &#123;</div><div class="line">        <span class="attr">type</span>: <span class="string">'rentals'</span>,</div><div class="line">        <span class="attr">id</span>: <span class="number">3</span>,</div><div class="line">        <span class="attr">attributes</span>: &#123;</div><div class="line">          <span class="attr">title</span>: <span class="string">'Downtown Charm'</span>,</div><div class="line">          <span class="attr">owner</span>: <span class="string">'Violet Beauregarde'</span>,</div><div class="line">          <span class="attr">city</span>: <span class="string">'Portland'</span>,</div><div class="line">          <span class="attr">type</span>: <span class="string">'Apartment'</span>,</div><div class="line">          <span class="attr">bedrooms</span>: <span class="number">3</span>,</div><div class="line">          <span class="attr">image</span>: <span class="string">'https://upload.wikimedia.org/wikipedia/commons/f/f7/Wheeldon_Apartment_Building_-_Portland_Oregon.jpg'</span></div><div class="line">        &#125;</div><div class="line">      &#125;];</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(request.queryParams.city !== <span class="literal">undefined</span>) &#123;</div><div class="line">      <span class="keyword">let</span> filteredRentals = rentals.filter(<span class="function"><span class="keyword">function</span>(<span class="params">i</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> i.attributes.city.toLowerCase().indexOf(request.queryParams.city.toLowerCase()) !== <span class="number">-1</span>;</div><div class="line">      &#125;);</div><div class="line">      <span class="keyword">return</span> &#123; <span class="attr">data</span>: filteredRentals &#125;;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> &#123; <span class="attr">data</span>: rentals &#125;;</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>完成以后如下图所示：</p>
<p><img src="/images/ember_tutorial/styled-super-rentals-filter.png" alt=""></p>
<h3 id="Services-and-Utilities"><a href="#Services-and-Utilities" class="headerlink" title="Services and Utilities"></a>Services and Utilities</h3><h3 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h3><p>打包代码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ ember build</div><div class="line"><span class="comment"># 建议以生产环境运行：</span></div><div class="line">$ ember build --environment=development</div></pre></td></tr></table></figure>
<p>会将生成好的代码全部打包在<code>dist/</code>文件夹下，之后怎么用就是自己的事喽</p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="http://github.com/probberechts">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Ember初探–Tutorial"><span class="toc-number">1.</span> <span class="toc-text">Ember初探–Tutorial</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建新的应用"><span class="toc-number">1.1.</span> <span class="toc-text">创建新的应用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#初始化应用"><span class="toc-number">1.1.1.</span> <span class="toc-text">初始化应用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#目录结构"><span class="toc-number">1.1.2.</span> <span class="toc-text">目录结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#start-server"><span class="toc-number">1.1.3.</span> <span class="toc-text">start server</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试先行"><span class="toc-number">1.2.</span> <span class="toc-text">测试先行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Routes-amp-Templates"><span class="toc-number">1.3.</span> <span class="toc-text">Routes & Templates</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#新建about路由"><span class="toc-number">1.3.1.</span> <span class="toc-text">新建about路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#新建contact路由"><span class="toc-number">1.3.2.</span> <span class="toc-text">新建contact路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用-lt-￼51-gt-编写导航"><span class="toc-number">1.3.3.</span> <span class="toc-text">使用{{link-to}}编写导航</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#增加首页"><span class="toc-number">1.3.4.</span> <span class="toc-text">增加首页</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#各页面使用通用的导航栏"><span class="toc-number">1.3.5.</span> <span class="toc-text">各页面使用通用的导航栏</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Model"><span class="toc-number">1.4.</span> <span class="toc-text">Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装附加插件"><span class="toc-number">1.5.</span> <span class="toc-text">安装附加插件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ember-cli-tutorial-style"><span class="toc-number">1.5.1.</span> <span class="toc-text">ember-cli-tutorial-style</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ember-cli-mirage"><span class="toc-number">1.5.2.</span> <span class="toc-text">ember-cli-mirage</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用Ember-Data"><span class="toc-number">1.6.</span> <span class="toc-text">使用Ember Data</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#更新Model-Hook（route-handler）"><span class="toc-number">1.6.1.</span> <span class="toc-text">更新Model Hook（route handler）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#建立简单的组件"><span class="toc-number">1.7.</span> <span class="toc-text">建立简单的组件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#组件的组成"><span class="toc-number">1.7.1.</span> <span class="toc-text">组件的组成</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#放大-缩小图片"><span class="toc-number">1.7.2.</span> <span class="toc-text">放大/缩小图片</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#建立Handlebars-Helper"><span class="toc-number">1.8.</span> <span class="toc-text">建立Handlebars Helper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#建立复杂组件"><span class="toc-number">1.9.</span> <span class="toc-text">建立复杂组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Services-and-Utilities"><span class="toc-number">1.10.</span> <span class="toc-text">Services and Utilities</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#部署"><span class="toc-number">1.11.</span> <span class="toc-text">部署</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/&text=Ember初探--Tutorial"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/&title=Ember初探--Tutorial"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/&is_video=false&description=Ember初探--Tutorial"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Ember初探--Tutorial&body=Check out this article: http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/&title=Ember初探--Tutorial"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/&title=Ember初探--Tutorial"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/&title=Ember初探--Tutorial"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/&title=Ember初探--Tutorial"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://ecmadao.com/2017/01/13/Notes/ember/Ember初探--Tutorial/&name=Ember初探--Tutorial&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick='$("#share-footer").toggle();return false;'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2017 ecmadao
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="http://github.com/probberechts">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    <script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-86660611-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'ecmadao-blog';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


</body>
</html>
