<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Table of Contents  generated with DocToc

Reduxå…¥å‘è¿›é˜¶-æºç è§£æ
é¢„çƒ­
æŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆcurryï¼‰
ä»£ç ç»„åˆï¼ˆcomposeï¼‰


Redux
combineReducers
createStore
thunkMiddleware
applyMiddleware
bindActionCreator
bindActionCreatoræºç è§£æ


r">
<meta property="og:type" content="article">
<meta property="og:title" content="Reduxå…¥å‘è¿›é˜¶-æºç è§£æ">
<meta property="og:url" content="http://ecmadao.com/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/index.html">
<meta property="og:site_name" content="ecmadao">
<meta property="og:description" content="Table of Contents  generated with DocToc

Reduxå…¥å‘è¿›é˜¶-æºç è§£æ
é¢„çƒ­
æŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆcurryï¼‰
ä»£ç ç»„åˆï¼ˆcomposeï¼‰


Redux
combineReducers
createStore
thunkMiddleware
applyMiddleware
bindActionCreator
bindActionCreatoræºç è§£æ


r">
<meta property="og:updated_time" content="2017-01-14T13:18:58.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Reduxå…¥å‘è¿›é˜¶-æºç è§£æ">
<meta name="twitter:description" content="Table of Contents  generated with DocToc

Reduxå…¥å‘è¿›é˜¶-æºç è§£æ
é¢„çƒ­
æŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆcurryï¼‰
ä»£ç ç»„åˆï¼ˆcomposeï¼‰


Redux
combineReducers
createStore
thunkMiddleware
applyMiddleware
bindActionCreator
bindActionCreatoræºç è§£æ


r">
    
    
        
          
              <link rel="shortcut icon" href="/Coding-Guide/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/Coding-Guide/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/Coding-Guide/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Reduxå…¥å‘è¿›é˜¶-æºç è§£æ</title>
    <!-- styles -->
    <link rel="stylesheet" href="/Coding-Guide/lib/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/Coding-Guide/lib/meslo-LG/styles.css">
    <link rel="stylesheet" href="/Coding-Guide/lib/justified-gallery/justifiedGallery.min.css">
    <link rel="stylesheet" href="/Coding-Guide/css/style.css">
    <!-- rss -->
    
    
    <!-- jquery -->
    <script src="/Coding-Guide/lib/jquery/jquery.min.js"></script>
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/Coding-Guide/">Home</a></li>
         
          <li><a href="/Coding-Guide/about/">About</a></li>
         
          <li><a href="/Coding-Guide/archives/">Articles</a></li>
         
          <li><a href="http://github.com/ecmadao">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘ç¬”è®°-ThinkInRedux/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li>
        
        
        <li><a class="icon" href="/Coding-Guide/2017/01/13/Notes/è¯‘æ–‡/ES6/ã€è¯‘æ–‡ã€‘ç”¨ES6å†™æ›´èµçš„JavaScriptï¼ˆ1ï¼‰/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/&text=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/&title=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/&is_video=false&description=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ&body=Check out this article: http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/&title=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/&title=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/&title=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/&title=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/&name=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><span class="toc-number">1.</span> <span class="toc-text">Reduxå…¥å‘è¿›é˜¶-æºç è§£æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#é¢„çƒ­"><span class="toc-number">1.1.</span> <span class="toc-text">é¢„çƒ­</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#æŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆcurryï¼‰"><span class="toc-number">1.1.1.</span> <span class="toc-text">æŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆcurryï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ä»£ç ç»„åˆï¼ˆcomposeï¼‰"><span class="toc-number">1.1.2.</span> <span class="toc-text">ä»£ç ç»„åˆï¼ˆcomposeï¼‰</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redux"><span class="toc-number">1.2.</span> <span class="toc-text">Redux</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#combineReducers"><span class="toc-number">1.2.1.</span> <span class="toc-text">combineReducers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#createStore"><span class="toc-number">1.2.2.</span> <span class="toc-text">createStore</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#thunkMiddleware"><span class="toc-number">1.2.3.</span> <span class="toc-text">thunkMiddleware</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#applyMiddleware"><span class="toc-number">1.2.4.</span> <span class="toc-text">applyMiddleware</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bindActionCreator"><span class="toc-number">1.2.5.</span> <span class="toc-text">bindActionCreator</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bindActionCreatoræºç è§£æ"><span class="toc-number">1.2.6.</span> <span class="toc-text">bindActionCreatoræºç è§£æ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#react-redux"><span class="toc-number">1.3.</span> <span class="toc-text">react-redux</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Provider"><span class="toc-number">1.3.1.</span> <span class="toc-text">Provider</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#connect"><span class="toc-number">1.3.2.</span> <span class="toc-text">connect</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Reduxå…¥å‘è¿›é˜¶-æºç è§£æ
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">ecmadao</span>
      </span>
      
    <div class="postdate">
        <time datetime="2017-01-13T05:58:37.000Z" itemprop="datePublished">2017-01-13</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/Coding-Guide/tags/React/">React</a>, <a class="tag-link" href="/Coding-Guide/tags/Redux/">Redux</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<p><strong>Table of Contents</strong>  <em>generated with <a href="https://github.com/thlorenz/doctoc" target="_blank" rel="external">DocToc</a></em></p>
<ul>
<li><a href="#redux%E5%85%A5%E5%9D%91%E8%BF%9B%E9%98%B6-%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90">Reduxå…¥å‘è¿›é˜¶-æºç è§£æ</a><ul>
<li><a href="#%E9%A2%84%E7%83%AD">é¢„çƒ­</a><ul>
<li><a href="#%E6%9F%AF%E9%87%8C%E5%8C%96%E5%87%BD%E6%95%B0%EF%BC%88curry%EF%BC%89">æŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆ<code>curry</code>ï¼‰</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81%E7%BB%84%E5%90%88%EF%BC%88compose%EF%BC%89">ä»£ç ç»„åˆï¼ˆ<code>compose</code>ï¼‰</a></li>
</ul>
</li>
<li><a href="#redux"><code>Redux</code></a><ul>
<li><a href="#combinereducers"><code>combineReducers</code></a></li>
<li><a href="#createstore"><code>createStore</code></a></li>
<li><a href="#thunkmiddleware"><code>thunkMiddleware</code></a></li>
<li><a href="#applymiddleware"><code>applyMiddleware</code></a></li>
<li><a href="#bindactioncreator"><code>bindActionCreator</code></a></li>
<li><a href="#bindactioncreator%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90"><code>bindActionCreator</code>æºç è§£æ</a></li>
</ul>
</li>
<li><a href="#react-redux"><code>react-redux</code></a><ul>
<li><a href="#provider"><code>Provider</code></a></li>
<li><a href="#connect"><code>connect</code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->
<h2 id="Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><a href="#Reduxå…¥å‘è¿›é˜¶-æºç è§£æ" class="headerlink" title="Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"></a>Reduxå…¥å‘è¿›é˜¶-æºç è§£æ</h2><blockquote>
<p>æœ¬æ–‡ä¸æ¶‰åŠreduxçš„ä½¿ç”¨æ–¹æ³•ï¼Œå› æ­¤å¯èƒ½æ›´é€‚åˆä½¿ç”¨è¿‡reduxçš„ç©å®¶ç¿»é˜…ğŸ˜ƒ</p>
</blockquote>
<h3 id="é¢„çƒ­"><a href="#é¢„çƒ­" class="headerlink" title="é¢„çƒ­"></a>é¢„çƒ­</h3><blockquote>
<p>redux å‡½æ•°å†…éƒ¨åŒ…å«äº†å¤§é‡<a href="https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/ch4.html" target="_blank" rel="external">æŸ¯é‡ŒåŒ–å‡½æ•°</a>ä»¥åŠ<a href="https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/ch5.html" target="_blank" rel="external">ä»£ç ç»„åˆ</a>æ€æƒ³</p>
</blockquote>
<h4 id="æŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆcurryï¼‰"><a href="#æŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆcurryï¼‰" class="headerlink" title="æŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆcurryï¼‰"></a>æŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆ<code>curry</code>ï¼‰</h4><p>é€šä¿—çš„æ¥è®²ï¼Œå¯ä»¥ç”¨ä¸€å¥è¯æ¦‚æ‹¬æŸ¯é‡ŒåŒ–å‡½æ•°ï¼šè¿”å›å‡½æ•°çš„å‡½æ•°</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// example</span></div><div class="line"><span class="keyword">const</span> funcA = <span class="function">(<span class="params">a</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">const</span> funcB = <span class="function">(<span class="params">b</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> a + b</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šè¿°çš„<code>funcA</code>å‡½æ•°æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œå¹¶è¿”å›åŒæ ·æ¥æ”¶ä¸€ä¸ªå‚æ•°çš„<code>funcB</code>å‡½æ•°ã€‚</p>
<p>æŸ¯é‡ŒåŒ–å‡½æ•°æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ</p>
<ul>
<li>é¿å…äº†ç»™ä¸€ä¸ªå‡½æ•°ä¼ å…¥å¤§é‡çš„å‚æ•°â€“æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¯é‡ŒåŒ–æ¥æ„å»ºç±»ä¼¼ä¸Šä¾‹çš„å‡½æ•°åµŒå¥—ï¼Œå°†å‚æ•°çš„ä»£å…¥åˆ†ç¦»å¼€ï¼Œæ›´æœ‰åˆ©äºè°ƒè¯•</li>
<li>é™ä½è€¦åˆåº¦å’Œä»£ç å†—ä½™ï¼Œä¾¿äºå¤ç”¨</li>
</ul>
<p>ä¸¾ä¸ªæ —å­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å·²çŸ¥listA, listBä¸¤ä¸ªArrayï¼Œéƒ½ç”±intç»„æˆï¼Œéœ€è¦ç­›é€‰å‡ºä¸¤ä¸ªArrayçš„äº¤é›†</span></div><div class="line"><span class="keyword">const</span> listA = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</div><div class="line"><span class="keyword">const</span> listB = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</div><div class="line"></div><div class="line"><span class="keyword">const</span> checkIfDataExist = <span class="function">(<span class="params">list</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">target</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> list.some(<span class="function"><span class="params">value</span> =&gt;</span> value === target)</div><div class="line">  &#125;;</div><div class="line">&#125;;</div><div class="line"><span class="comment">// è°ƒç”¨ä¸€æ¬¡checkIfDataExistå‡½æ•°ï¼Œå¹¶å°†listAä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œæ¥æ„å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚</span></div><div class="line"><span class="comment">// è€Œæ–°å‡½æ•°çš„ä½œç”¨åˆ™æ˜¯ï¼šæ£€æŸ¥ä¼ å…¥çš„å‚æ•°æ˜¯å¦å­˜åœ¨äºlistAé‡Œ</span></div><div class="line"><span class="keyword">const</span> ifDataExist = checkIfDataExist(listA);</div><div class="line"></div><div class="line"><span class="comment">// ä½¿ç”¨æ–°å‡½æ•°æ¥å¯¹listBé‡Œçš„æ¯ä¸€ä¸ªå…ƒç´ è¿›è¡Œç­›é€‰</span></div><div class="line"><span class="keyword">const</span> intersectionList = listB.filter(<span class="function"><span class="params">value</span> =&gt;</span> ifDataExist(value));</div><div class="line"><span class="built_in">console</span>.log(intersectionList); <span class="comment">// [2, 3, 4]</span></div></pre></td></tr></table></figure>
<h4 id="ä»£ç ç»„åˆï¼ˆcomposeï¼‰"><a href="#ä»£ç ç»„åˆï¼ˆcomposeï¼‰" class="headerlink" title="ä»£ç ç»„åˆï¼ˆcomposeï¼‰"></a>ä»£ç ç»„åˆï¼ˆ<code>compose</code>ï¼‰</h4><p>ä»£ç ç»„åˆå°±åƒæ˜¯æ•°å­¦ä¸­çš„ç»“åˆå¾‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> compose = <span class="function">(<span class="params">f, g</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">x</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> f(g(x));</div><div class="line">  &#125;;</div><div class="line">&#125;;</div><div class="line"><span class="comment">// è¿˜å¯ä»¥å†ç®€æ´ç‚¹</span></div><div class="line"><span class="keyword">const</span> compose = <span class="function">(<span class="params">f, g</span>) =&gt;</span> (x) =&gt; f(g(x));</div></pre></td></tr></table></figure>
<p>é€šè¿‡è¿™æ ·å‡½æ•°ä¹‹é—´çš„ç»„åˆï¼Œå¯ä»¥å¤§å¤§å¢åŠ å¯è¯»æ€§ï¼Œæ•ˆæœè¿œå¤§äºåµŒå¥—ä¸€å¤§å †çš„å‡½æ•°è°ƒç”¨ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥éšæ„æ›´æ”¹å‡½æ•°çš„è°ƒç”¨é¡ºåº</p>
<h3 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a><code>Redux</code></h3><h4 id="combineReducers"><a href="#combineReducers" class="headerlink" title="combineReducers"></a><code>combineReducers</code></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å›é¡¾ä¸€ä¸‹combineReducersçš„ä½¿ç”¨æ ¼å¼</span></div><div class="line"></div><div class="line"><span class="comment">// ä¸¤ä¸ªreducer</span></div><div class="line"><span class="keyword">const</span> todos = <span class="function">(<span class="params">state = INIT.todos, action</span>) =&gt;</span> &#123;</div><div class="line">  <span class="comment">// ....</span></div><div class="line">&#125;;</div><div class="line"><span class="keyword">const</span> filterStatus = <span class="function">(<span class="params">state = INIT.filterStatus, action</span>) =&gt;</span> &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> appReducer = combineReducers(&#123;</div><div class="line">  todos,</div><div class="line">  filterStatus</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<blockquote>
<p>è¿˜è®°å¾—<code>combineReducers</code>çš„é»‘é­”æ³•å—ï¼Ÿå³ï¼š</p>
<ol>
<li><p>ä¼ å…¥çš„Objectå‚æ•°ä¸­ï¼Œå¯¹è±¡çš„<code>key</code>ä¸<code>value</code>æ‰€ä»£è¡¨çš„<code>reducer function</code>åŒå</p>
</li>
<li><p>å„ä¸ª<code>reducer function</code>çš„åç§°å’Œéœ€è¦ä¼ å…¥è¯¥reducerçš„<code>state</code>å‚æ•°åŒåã€‚</p>
</li>
</ol>
</blockquote>
<p>æºç æ ‡æ³¨è§£è¯»ï¼ˆçœç•¥éƒ¨åˆ†ï¼‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">combineReducers</span>(<span class="params">reducers</span>) </span>&#123;</div><div class="line">  <span class="comment">// ç¬¬ä¸€æ¬¡ç­›é€‰ï¼Œå‚æ•°reducersä¸ºObject</span></div><div class="line">  <span class="comment">// ç­›é€‰æ‰reducersä¸­ä¸æ˜¯functionçš„é”®å€¼å¯¹</span></div><div class="line">  <span class="keyword">var</span> reducerKeys = <span class="built_in">Object</span>.keys(reducers);</div><div class="line">  <span class="keyword">var</span> finalReducers = &#123;&#125;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; reducerKeys.length; i++) &#123;</div><div class="line">    <span class="keyword">var</span> key = reducerKeys[i];</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> reducers[key] === <span class="string">'function'</span>) &#123;</div><div class="line">      finalReducers[key] = reducers[key]</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> finalReducerKeys = <span class="built_in">Object</span>.keys(finalReducers)</div><div class="line"></div><div class="line">  <span class="comment">// äºŒæ¬¡ç­›é€‰ï¼Œåˆ¤æ–­reducerä¸­ä¼ å…¥çš„å€¼æ˜¯å¦åˆæ³•ï¼ˆ!== undefinedï¼‰</span></div><div class="line">  <span class="comment">// è·å–ç­›é€‰å®Œä¹‹åçš„æ‰€æœ‰key</span></div><div class="line">  <span class="keyword">var</span> sanityError</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="comment">// assertReducerSanityå‡½æ•°ç”¨äºéå†finalReducersä¸­çš„reducerï¼Œæ£€æŸ¥ä¼ å…¥reducerçš„stateæ˜¯å¦åˆæ³•</span></div><div class="line">    assertReducerSanity(finalReducers)</div><div class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">    sanityError = e</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="comment">// è¿”å›ä¸€ä¸ªfunctionã€‚è¯¥æ–¹æ³•æ¥æ”¶stateå’Œactionä½œä¸ºå‚æ•°</span></div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">combination</span>(<span class="params">state = &#123;&#125;, action</span>) </span>&#123;</div><div class="line">    <span class="comment">// å¦‚æœä¹‹å‰çš„åˆ¤æ–­reducersä¸­æœ‰ä¸æ³•å€¼ï¼Œåˆ™æŠ›å‡ºé”™è¯¯</span></div><div class="line">    <span class="keyword">if</span> (sanityError) &#123;</div><div class="line">      <span class="keyword">throw</span> sanityError</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// å¦‚æœä¸æ˜¯productionç¯å¢ƒåˆ™æŠ›å‡ºwarning</span></div><div class="line">    <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</div><div class="line">      <span class="keyword">var</span> warningMessage = getUnexpectedStateShapeWarningMessage(state, finalReducers, action)</div><div class="line">      <span class="keyword">if</span> (warningMessage) &#123;</div><div class="line">        warning(warningMessage)</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> hasChanged = <span class="literal">false</span></div><div class="line">    <span class="keyword">var</span> nextState = &#123;&#125;</div><div class="line">    <span class="comment">// éå†æ‰€æœ‰çš„keyå’Œreducerï¼Œåˆ†åˆ«å°†reducerå¯¹åº”çš„keyæ‰€ä»£è¡¨çš„stateï¼Œä»£å…¥åˆ°reducerä¸­è¿›è¡Œå‡½æ•°è°ƒç”¨</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; finalReducerKeys.length; i++) &#123;</div><div class="line">      <span class="keyword">var</span> key = finalReducerKeys[i]</div><div class="line">      <span class="keyword">var</span> reducer = finalReducers[key]</div><div class="line">      <span class="comment">// è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆè¯´combineReducersé»‘é­”æ³•--è¦æ±‚ä¼ å…¥çš„Objectå‚æ•°ä¸­ï¼Œreducer functionçš„åç§°å’Œè¦å’ŒstateåŒåçš„åŸå› </span></div><div class="line">      <span class="keyword">var</span> previousStateForKey = state[key]</div><div class="line">      <span class="keyword">var</span> nextStateForKey = reducer(previousStateForKey, action)</div><div class="line">      <span class="comment">// å¦‚æœreducerè¿”å›undefinedåˆ™æŠ›å‡ºé”™è¯¯</span></div><div class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> nextStateForKey === <span class="string">'undefined'</span>) &#123;</div><div class="line">        <span class="keyword">var</span> errorMessage = getUndefinedStateErrorMessage(key, action)</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(errorMessage)</div><div class="line">      &#125;</div><div class="line">      <span class="comment">// å°†reducerè¿”å›çš„å€¼å¡«å…¥nextState</span></div><div class="line">      nextState[key] = nextStateForKey</div><div class="line">      <span class="comment">// å¦‚æœä»»ä¸€stateæœ‰æ›´æ–°åˆ™hasChangedä¸ºtrue</span></div><div class="line">      hasChanged = hasChanged || nextStateForKey !== previousStateForKey</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> hasChanged ? nextState : state</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æ£€æŸ¥ä¼ å…¥reducerçš„stateæ˜¯å¦åˆæ³•</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">assertReducerSanity</span>(<span class="params">reducers</span>) </span>&#123;</div><div class="line">  <span class="built_in">Object</span>.keys(reducers).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">var</span> reducer = reducers[key]</div><div class="line">    <span class="comment">// éå†å…¨éƒ¨reducerï¼Œå¹¶ç»™å®ƒä¼ å…¥(undefined, action)</span></div><div class="line">    <span class="comment">// å½“ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥undefinedæ—¶ï¼Œåˆ™ä¸ºå„ä¸ªreducerå®šä¹‰çš„é»˜è®¤å‚æ•°</span></div><div class="line">    <span class="keyword">var</span> initialState = reducer(<span class="literal">undefined</span>, &#123; <span class="attr">type</span>: ActionTypes.INIT &#125;)</div><div class="line">    </div><div class="line">    <span class="comment">// ActionTypes.INITå‡ ä¹ä¸ä¼šè¢«å®šä¹‰ï¼Œæ‰€ä»¥ä¼šé€šè¿‡switchçš„defaultè¿”å›reducerçš„é»˜è®¤å‚æ•°ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šé»˜è®¤å‚æ•°ï¼Œåˆ™è¿”å›undefinedï¼ŒæŠ›å‡ºé”™è¯¯</span></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> initialState === <span class="string">'undefined'</span>) &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(</div><div class="line">        <span class="string">`Reducer "<span class="subst">$&#123;key&#125;</span>" returned undefined during initialization. `</span> +</div><div class="line">        <span class="string">`If the state passed to the reducer is undefined, you must `</span> +</div><div class="line">        <span class="string">`explicitly return the initial state. The initial state may `</span> +</div><div class="line">        <span class="string">`not be undefined.`</span></div><div class="line">      )</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> type = <span class="string">'@@redux/PROBE_UNKNOWN_ACTION_'</span> + <span class="built_in">Math</span>.random().toString(<span class="number">36</span>).substring(<span class="number">7</span>).split(<span class="string">''</span>).join(<span class="string">'.'</span>)</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> reducer(<span class="literal">undefined</span>, &#123; type &#125;) === <span class="string">'undefined'</span>) &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(</div><div class="line">        <span class="string">`Reducer "<span class="subst">$&#123;key&#125;</span>" returned undefined when probed with a random type. `</span> +</div><div class="line">        <span class="string">`Don't try to handle <span class="subst">$&#123;ActionTypes.INIT&#125;</span> or other actions in "redux/*" `</span> +</div><div class="line">        <span class="string">`namespace. They are considered private. Instead, you must return the `</span> +</div><div class="line">        <span class="string">`current state for any unknown actions, unless it is undefined, `</span> +</div><div class="line">        <span class="string">`in which case you must return the initial state, regardless of the `</span> +</div><div class="line">        <span class="string">`action type. The initial state may not be undefined.`</span></div><div class="line">      )</div><div class="line">    &#125;</div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="createStore"><a href="#createStore" class="headerlink" title="createStore"></a><code>createStore</code></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å›é¡¾ä¸‹ä½¿ç”¨æ–¹æ³•</span></div><div class="line"><span class="keyword">const</span> store = createStore(reducers, state, enhance);</div></pre></td></tr></table></figure>
<p>æºç æ ‡æ³¨è§£è¯»ï¼ˆçœç•¥éƒ¨åˆ†ï¼‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å¯¹äºæœªçŸ¥çš„action.typeï¼Œreducerå¿…é¡»è¿”å›é»˜è®¤çš„å‚æ•°stateã€‚è¿™ä¸ªActionTypes.INITå°±å¯ä»¥ç”¨æ¥ç›‘æµ‹å½“reducerä¼ å…¥æœªçŸ¥typeçš„actionæ—¶ï¼Œè¿”å›çš„stateæ˜¯å¦åˆæ³•</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">var</span> ActionTypes = &#123;</div><div class="line">  <span class="attr">INIT</span>: <span class="string">'@@redux/INIT'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">createStore</span>(<span class="params">reducer, initialState, enhancer</span>) </span>&#123;</div><div class="line">  <span class="comment">// æ£€æŸ¥ä½ çš„stateå’Œenhanceå‚æ•°æœ‰æ²¡æœ‰ä¼ å</span></div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> initialState === <span class="string">'function'</span> &amp;&amp; <span class="keyword">typeof</span> enhancer === <span class="string">'undefined'</span>) &#123;</div><div class="line">    enhancer = initialState</div><div class="line">    initialState = <span class="literal">undefined</span></div><div class="line">  &#125;</div><div class="line">  <span class="comment">// å¦‚æœæœ‰ä¼ å…¥åˆæ³•çš„enhanceï¼Œåˆ™é€šè¿‡enhancerå†è°ƒç”¨ä¸€æ¬¡createStore</span></div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> enhancer !== <span class="string">'undefined'</span>) &#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> enhancer !== <span class="string">'function'</span>) &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Expected the enhancer to be a function.'</span>)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> enhancer(createStore)(reducer, initialState)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> reducer !== <span class="string">'function'</span>) &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Expected the reducer to be a function.'</span>)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> currentReducer = reducer</div><div class="line">  <span class="keyword">var</span> currentState = initialState</div><div class="line">  <span class="keyword">var</span> currentListeners = []</div><div class="line">  <span class="keyword">var</span> nextListeners = currentListeners</div><div class="line">  <span class="keyword">var</span> isDispatching = <span class="literal">false</span> <span class="comment">// æ˜¯å¦æ­£åœ¨åˆ†å‘äº‹ä»¶</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">ensureCanMutateNextListeners</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (nextListeners === currentListeners) &#123;</div><div class="line">      nextListeners = currentListeners.slice()</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// æˆ‘ä»¬åœ¨action middlewareä¸­ç»å¸¸ä½¿ç”¨çš„getState()æ–¹æ³•ï¼Œè¿”å›å½“å‰state</span></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getState</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> currentState</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// æ³¨å†Œlistenerï¼ŒåŒæ—¶è¿”å›ä¸€ä¸ªå–æ¶ˆäº‹ä»¶æ³¨å†Œçš„æ–¹æ³•ã€‚å½“è°ƒç”¨store.dispatchçš„æ—¶å€™è°ƒç”¨listener</span></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">subscribe</span>(<span class="params">listener</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> listener !== <span class="string">'function'</span>) &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Expected listener to be a function.'</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> isSubscribed = <span class="literal">true</span></div><div class="line"></div><div class="line">    ensureCanMutateNextListeners()</div><div class="line">    nextListeners.push(listener)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">unsubscribe</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span> (!isSubscribed) &#123;</div><div class="line">        <span class="keyword">return</span></div><div class="line">      &#125;</div><div class="line"></div><div class="line">      isSubscribed = <span class="literal">false</span></div><div class="line">      <span class="comment">// ä»nextListenersä¸­å»é™¤æ‰å½“å‰listener</span></div><div class="line">      ensureCanMutateNextListeners()</div><div class="line">      <span class="keyword">var</span> index = nextListeners.indexOf(listener)</div><div class="line">      nextListeners.splice(index, <span class="number">1</span>)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// dispatchæ–¹æ³•æ¥æ”¶çš„actionæ˜¯ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯æ–¹æ³•ã€‚</span></div><div class="line">  <span class="comment">// è¿™ä¸ªå¯¹è±¡å®é™…ä¸Šå°±æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰actionçš„è¿”å›å€¼ï¼Œå› ä¸ºdispatchçš„æ—¶å€™ï¼Œå·²ç»è°ƒç”¨è¿‡æˆ‘ä»¬çš„è‡ªå®šä¹‰actionäº†ï¼Œæ¯”å¦‚ dispatch(addTodo())</span></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">dispatch</span>(<span class="params">action</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (!isPlainObject(action)) &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(</div><div class="line">        <span class="string">'Actions must be plain objects. '</span> +</div><div class="line">        <span class="string">'Use custom middleware for async actions.'</span></div><div class="line">      )</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> action.type === <span class="string">'undefined'</span>) &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(</div><div class="line">        <span class="string">'Actions may not have an undefined "type" property. '</span> +</div><div class="line">        <span class="string">'Have you misspelled a constant?'</span></div><div class="line">      )</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// è°ƒç”¨dispatchçš„æ—¶å€™åªèƒ½ä¸€ä¸ªä¸ªè°ƒç”¨ï¼Œé€šè¿‡dispatchåˆ¤æ–­è°ƒç”¨çš„çŠ¶æ€</span></div><div class="line">    <span class="keyword">if</span> (isDispatching) &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Reducers may not dispatch actions.'</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      isDispatching = <span class="literal">true</span></div><div class="line">      currentState = currentReducer(currentState, action)</div><div class="line">    &#125; <span class="keyword">finally</span> &#123;</div><div class="line">      isDispatching = <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">    <span class="comment">// éå†è°ƒç”¨å„ä¸ªlinster</span></div><div class="line">    <span class="keyword">var</span> listeners = currentListeners = nextListeners</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; listeners.length; i++) &#123;</div><div class="line">      listeners[i]()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> action</div><div class="line">  &#125;</div><div class="line">  <span class="comment">// Replaces the reducer currently used by the store to calculate the state.</span></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">replaceReducer</span>(<span class="params">nextReducer</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> nextReducer !== <span class="string">'function'</span>) &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Expected the nextReducer to be a function.'</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    currentReducer = nextReducer</div><div class="line">    dispatch(&#123; <span class="attr">type</span>: ActionTypes.INIT &#125;)</div><div class="line">  &#125;</div><div class="line">  <span class="comment">// å½“create storeçš„æ—¶å€™ï¼Œreducerä¼šæ¥å—ä¸€ä¸ªtypeä¸ºActionTypes.INITçš„actionï¼Œä½¿reducerè¿”å›ä»–ä»¬é»˜è®¤çš„stateï¼Œè¿™æ ·å¯ä»¥å¿«é€Ÿçš„å½¢æˆé»˜è®¤çš„stateçš„ç»“æ„</span></div><div class="line">  dispatch(&#123; <span class="attr">type</span>: ActionTypes.INIT &#125;)</div><div class="line"></div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    dispatch,</div><div class="line">    subscribe,</div><div class="line">    getState,</div><div class="line">    replaceReducer</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="thunkMiddleware"><a href="#thunkMiddleware" class="headerlink" title="thunkMiddleware"></a><code>thunkMiddleware</code></h4><p>æºç åŠå…¶ç®€å•ç®€ç›´ç»™è·ªâ€¦</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è¿”å›ä»¥ dispatch å’Œ getState ä½œä¸ºå‚æ•°çš„action</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">thunkMiddleware</span>(<span class="params">&#123; dispatch, getState &#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="params">next</span> =&gt;</span> action =&gt; &#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> action === <span class="string">'function'</span>) &#123;</div><div class="line">      <span class="keyword">return</span> action(dispatch, getState);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> next(action);</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="applyMiddleware"><a href="#applyMiddleware" class="headerlink" title="applyMiddleware"></a><code>applyMiddleware</code></h4><p>å…ˆå¤ä¹ ä¸‹ç”¨æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// usage</span></div><div class="line"><span class="keyword">import</span> &#123;createStore, applyMiddleware&#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> thunkMiddleware <span class="keyword">from</span> <span class="string">'redux-thunk'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> store = createStore(</div><div class="line">      reducers,</div><div class="line">      state,</div><div class="line">      applyMiddleware(thunkMiddleware)</div><div class="line">);</div></pre></td></tr></table></figure>
<p><code>applyMiddleware</code>é¦–å…ˆæ¥æ”¶<code>thunkMiddleware</code>ä½œä¸ºå‚æ•°ï¼Œä¸¤è€…ç»„åˆæˆä¸ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼ˆ<code>enhance</code>ï¼‰ï¼Œä¹‹ååœ¨<code>createStore</code>å†…éƒ¨ï¼Œå› ä¸º<code>enhance</code>çš„å­˜åœ¨ï¼Œå°†ä¼šå˜æˆè¿”å›<code>enhancer(createStore)(reducer, initialState)</code></p>
<p>æºç æ ‡æ³¨è§£è¯»ï¼ˆçœç•¥éƒ¨åˆ†ï¼‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªä»£ç ç»„åˆçš„æ–¹æ³•</span></div><div class="line"><span class="comment">// ä¼ å…¥ä¸€äº›functionä½œä¸ºå‚æ•°ï¼Œè¿”å›å…¶é“¾å¼è°ƒç”¨çš„å½¢æ€ã€‚ä¾‹å¦‚ï¼Œ</span></div><div class="line"><span class="comment">// compose(f, g, h) æœ€ç»ˆè¿”å› (...args) =&gt; f(g(h(...args)))</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">compose</span>(<span class="params">...funcs</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (funcs.length === <span class="number">0</span>) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="params">arg</span> =&gt;</span> arg</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">const</span> last = funcs[funcs.length - <span class="number">1</span>]</div><div class="line">    <span class="keyword">const</span> rest = funcs.slice(<span class="number">0</span>, <span class="number">-1</span>)</div><div class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">...args</span>) =&gt;</span> rest.reduceRight(<span class="function">(<span class="params">composed, f</span>) =&gt;</span> f(composed), last(...args))</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">applyMiddleware</span>(<span class="params">...middlewares</span>) </span>&#123;</div><div class="line">  <span class="comment">// æœ€ç»ˆè¿”å›ä¸€ä¸ªä»¥createStoreä¸ºå‚æ•°çš„åŒ¿åå‡½æ•°</span></div><div class="line">  <span class="comment">// è¿™ä¸ªå‡½æ•°è¿”å›å¦ä¸€ä¸ªä»¥reducer, initialState, enhancerä¸ºå‚æ•°çš„åŒ¿åå‡½æ•°</span></div><div class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">createStore</span>) =&gt;</span> (reducer, initialState, enhancer) =&gt; &#123;</div><div class="line">    <span class="keyword">var</span> store = createStore(reducer, initialState, enhancer)</div><div class="line">    <span class="keyword">var</span> dispatch</div><div class="line">    <span class="keyword">var</span> chain = []</div><div class="line"></div><div class="line">    <span class="keyword">var</span> middlewareAPI = &#123;</div><div class="line">      <span class="attr">getState</span>: store.getState,</div><div class="line">      <span class="attr">dispatch</span>: <span class="function">(<span class="params">action</span>) =&gt;</span> dispatch(action)</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// æ¯ä¸ª middleware éƒ½ä»¥ middlewareAPI ä½œä¸ºå‚æ•°è¿›è¡Œæ³¨å…¥ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„é“¾ã€‚æ­¤æ—¶çš„è¿”å›å€¼ç›¸å½“äºè°ƒç”¨ thunkMiddleware è¿”å›çš„å‡½æ•°ï¼š (next) =&gt; (action) =&gt; &#123;&#125; ï¼Œæ¥æ”¶ä¸€ä¸ªnextä½œä¸ºå…¶å‚æ•°</span></div><div class="line">    chain = middlewares.map(<span class="function"><span class="params">middleware</span> =&gt;</span> middleware(middlewareAPI))</div><div class="line">    <span class="comment">// å¹¶å°†é“¾ä»£å…¥è¿› compose ç»„æˆä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨é“¾</span></div><div class="line">    <span class="comment">// compose(...chain) è¿”å›å½¢å¦‚(...args) =&gt; f(g(h(...args)))ï¼Œf/g/héƒ½æ˜¯chainä¸­çš„å‡½æ•°å¯¹è±¡ã€‚</span></div><div class="line">    <span class="comment">// åœ¨ç›®å‰åªæœ‰ thunkMiddleware ä½œä¸º middlewares å‚æ•°çš„æƒ…å†µä¸‹ï¼Œå°†è¿”å› (next) =&gt; (action) =&gt; &#123;&#125;</span></div><div class="line">    <span class="comment">// ä¹‹åä»¥ store.dispatch ä½œä¸ºå‚æ•°è¿›è¡Œæ³¨å…¥</span></div><div class="line">    dispatch = compose(...chain)(store.dispatch)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      ...store,</div><div class="line">      dispatch</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸€è„¸æ‡µé€¼ï¼Ÿæ²¡å…³ç³»ï¼Œæ¥ç»“åˆå®é™…ä½¿ç”¨æ€»ç»“ä¸€ä¸‹ï¼š</p>
<p>å½“æˆ‘ä»¬æ­é…<code>redux-thunk</code>è¿™ä¸ªåº“çš„æ—¶å€™ï¼Œåœ¨<code>redux</code>é…åˆ<code>components</code>æ—¶ï¼Œé€šå¸¸è¿™ä¹ˆå†™</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> thunkMiddleware <span class="keyword">from</span> <span class="string">'redux-thunk'</span>;</div><div class="line"><span class="keyword">import</span> &#123; createStore, applyMiddleware, combineReducer &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> reducers <span class="keyword">from</span> <span class="string">'./reducers.js'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> appReducer = combineReducer(reducers);</div><div class="line"><span class="keyword">const</span> store = createStore(appReducer, initialState, applyMiddleware(thunkMiddleware));</div></pre></td></tr></table></figure>
<p>è¿˜è®°å¾—å½“<code>createStore</code>æ”¶åˆ°çš„å‚æ•°ä¸­æœ‰<code>enhance</code>æ—¶ä¼šæ€ä¹ˆåšå—ï¼Ÿ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// createStore.js</span></div><div class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> enhancer !== <span class="string">'undefined'</span>) &#123;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> enhancer !== <span class="string">'function'</span>) &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Expected the enhancer to be a function.'</span>)</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> enhancer(createStore)(reducer, initialState)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼šå˜æˆä¸‹é¢çš„æƒ…å†µ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">applyMiddleware(thunkMiddleware)(createStore)(reducer, initialState)</div></pre></td></tr></table></figure>
<ul>
<li><code>applyMiddleware(thunkMiddleware)</code></li>
</ul>
<p><code>applyMiddleware</code>æ¥æ”¶<code>thunkMiddleware</code>ä½œä¸ºå‚æ•°ï¼Œè¿”å›å½¢å¦‚<code>(createStore) =&gt; (reducer, initialState, enhancer) =&gt; {}</code>çš„å‡½æ•°ã€‚</p>
<ul>
<li><code>applyMiddleware(thunkMiddleware)(createStore)</code></li>
</ul>
<p>ä»¥ createStore ä½œä¸ºå‚æ•°ï¼Œè°ƒç”¨ä¸Šä¸€æ­¥è¿”å›çš„å‡½æ•°<code>(reducer, initialState, enhancer) =&gt; {}</code></p>
<ul>
<li><code>applyMiddleware(thunkMiddleware)(createStore)(reducer, initialState)</code></li>
</ul>
<p>ä»¥ï¼ˆreducer, initialStateï¼‰ä¸ºå‚æ•°è¿›è¡Œè°ƒç”¨ã€‚<br>åœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨ï¼Œ<code>thunkMiddleware</code>è¢«è°ƒç”¨ï¼Œå…¶ä½œç”¨æ˜¯ç›‘æµ‹<code>type</code>æ˜¯<code>function</code>çš„<code>action</code></p>
<p>å› æ­¤ï¼Œå¦‚æœ<code>dispatch</code>çš„<code>action</code>è¿”å›çš„æ˜¯ä¸€ä¸ª<code>function</code>ï¼Œåˆ™è¯æ˜æ˜¯ä¸­é—´ä»¶ï¼Œåˆ™å°†<code>(dispatch, getState)</code>ä½œä¸ºå‚æ•°ä»£å…¥å…¶ä¸­ï¼Œè¿›è¡Œ<code>action</code> å†…éƒ¨ä¸‹ä¸€æ­¥çš„æ“ä½œã€‚å¦åˆ™çš„è¯ï¼Œè®¤ä¸ºåªæ˜¯ä¸€ä¸ªæ™®é€šçš„<code>action</code>ï¼Œå°†é€šè¿‡<code>next</code>(ä¹Ÿå°±æ˜¯<code>dispatch</code>)è¿›ä¸€æ­¥åˆ†å‘</p>
<hr>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>applyMiddleware(thunkMiddleware)</code>ä½œä¸º<code>enhance</code>ï¼Œæœ€ç»ˆèµ·äº†è¿™æ ·çš„ä½œç”¨ï¼š</p>
<p>å¯¹<code>dispatch</code>è°ƒç”¨çš„<code>action</code>(ä¾‹å¦‚ï¼Œ<code>dispatch(addNewTodo(todo)))</code>è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœ<code>action</code>åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨ä¹‹åè¿”å›çš„æ˜¯<code>function</code>ï¼Œåˆ™å°†<code>(dispatch, getState)</code>ä½œä¸ºå‚æ•°æ³¨å…¥åˆ°<code>action</code>è¿”å›çš„æ–¹æ³•ä¸­ï¼Œå¦åˆ™å°±æ­£å¸¸å¯¹<code>action</code>è¿›è¡Œåˆ†å‘ï¼Œè¿™æ ·ä¸€æ¥æˆ‘ä»¬çš„ä¸­é—´ä»¶å°±å®Œæˆå–½~</p>
<p>å› æ­¤ï¼Œå½“<code>action</code>å†…éƒ¨éœ€è¦è·å–<code>state</code>ï¼Œæˆ–è€…éœ€è¦è¿›è¡Œå¼‚æ­¥æ“ä½œï¼Œåœ¨æ“ä½œå®Œæˆä¹‹åè¿›è¡Œäº‹ä»¶è°ƒç”¨åˆ†å‘çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®©<code>action</code> è¿”å›ä¸€ä¸ªä»¥<code>(dispatch, getState)</code>ä¸ºå‚æ•°çš„<code>function</code>è€Œä¸æ˜¯é€šå¸¸çš„<code>Object</code>ï¼Œ<code>enhance</code>å°±ä¼šå¯¹å…¶è¿›è¡Œæ£€æµ‹ä»¥ä¾¿æ­£ç¡®çš„å¤„ç†</p>
<h4 id="bindActionCreator"><a href="#bindActionCreator" class="headerlink" title="bindActionCreator"></a><code>bindActionCreator</code></h4><blockquote>
<p>è¿™ä¸ªæ–¹æ³•æ„Ÿè§‰æ¯”è¾ƒå°‘è§ï¼Œæˆ‘ä¸ªäººä¹Ÿå¾ˆå°‘ç”¨åˆ°</p>
</blockquote>
<p>åœ¨ä¼ ç»Ÿå†™æ³•ä¸‹ï¼Œå½“æˆ‘ä»¬è¦æŠŠ state å’Œ action æ³¨å…¥åˆ°å­ç»„ä»¶ä¸­æ—¶ï¼Œä¸€èˆ¬ä¼šè¿™ä¹ˆåšï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123;addTodo, deleteTodo&#125; <span class="keyword">from</span> <span class="string">'./action.js'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoComponect</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">ChildComponent</span> </span></span></div><div class="line">        <span class="attr">deleteTodo</span>=<span class="string">&#123;this.props.deleteTodo&#125;</span></div><div class="line">        <span class="attr">addTodo</span>=<span class="string">&#123;this.props.addTodo&#125;</span></div><div class="line">      /&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">function mapStateToProps(state) &#123;</div><div class="line">  return &#123;</div><div class="line">    state</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">function mapDispatchToProps(dispatch) &#123;</div><div class="line">  return &#123;</div><div class="line">    deleteTodo: (id) =&gt; &#123;</div><div class="line">      dispatch(deleteTodo(id));</div><div class="line">    &#125;,</div><div class="line">    addTodo: (todo) =&gt; &#123;</div><div class="line">      dispatch(addTodo(todo));</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">export default connect(mapStateToProps, mapDispatchToProps)(TodoComponect);</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨<code>bindActionCreators</code>å¯ä»¥æŠŠ action è½¬ä¸ºåŒå key çš„å¯¹è±¡ï¼Œä½†ä½¿ç”¨ dispatch æŠŠæ¯ä¸ª action åŒ…å›´èµ·æ¥è°ƒç”¨</p>
<p><em>æƒŸä¸€ä½¿ç”¨ bindActionCreators çš„åœºæ™¯æ˜¯å½“ä½ éœ€è¦æŠŠ action creator å¾€ä¸‹ä¼ åˆ°ä¸€ä¸ªç»„ä»¶ä¸Šï¼Œå´ä¸æƒ³è®©è¿™ä¸ªç»„ä»¶è§‰å¯Ÿåˆ° Redux çš„å­˜åœ¨ï¼Œè€Œä¸”ä¸å¸Œæœ›æŠŠ Redux store æˆ– dispatch ä¼ ç»™å®ƒ</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; bindActionCreators &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123;addTodo, deleteTodo&#125; <span class="keyword">as</span> TodoActions <span class="keyword">from</span> <span class="string">'./action.js'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoComponect</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  </div><div class="line">  <span class="comment">// åœ¨æœ¬ç»„ä»¶å†…çš„åº”ç”¨</span></div><div class="line">  addTodo(todo) &#123;</div><div class="line">    <span class="keyword">let</span> action = TodoActions.addTodo(todo);</div><div class="line">    <span class="keyword">this</span>.props.dispatch(action);</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  deleteTodo(id) &#123;</div><div class="line">    <span class="keyword">let</span> action = TodoActions.deleteTodo(id);</div><div class="line">    <span class="keyword">this</span>.props.dispatch(action);</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">let</span> dispatch = <span class="keyword">this</span>.props.dispatch;</div><div class="line">    <span class="comment">// ä¼ é€’ç»™å­ç»„ä»¶</span></div><div class="line">    <span class="keyword">let</span> boundActionCreators = bindActionCreators(TodoActions, dispatch);</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">ChildComponent</span> </span></span></div><div class="line">        &#123;<span class="attr">...boundActionCreators</span>&#125;</div><div class="line">      /&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">function mapStateToProps(state) &#123;</div><div class="line">  return &#123;</div><div class="line">    state</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">export default connect(mapStateToProps)(TodoComponect)</div></pre></td></tr></table></figure>
<h4 id="bindActionCreatoræºç è§£æ"><a href="#bindActionCreatoræºç è§£æ" class="headerlink" title="bindActionCreatoræºç è§£æ"></a><code>bindActionCreator</code>æºç è§£æ</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bindActionCreator</span>(<span class="params">actionCreator, dispatch</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">...args</span>) =&gt;</span> dispatch(actionCreator(...args))</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// bindActionCreatorsæœŸå¾…ä¸€ä¸ªObjectä½œä¸ºactionCreatorsä¼ å…¥ï¼Œé‡Œé¢æ˜¯ key: action</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">bindActionCreators</span>(<span class="params">actionCreators, dispatch</span>) </span>&#123;</div><div class="line">  <span class="comment">// å¦‚æœåªæ˜¯ä¼ å…¥ä¸€ä¸ªactionï¼Œåˆ™é€šè¿‡bindActionCreatorè¿”å›è¢«ç»‘å®šåˆ°dispatchçš„å‡½æ•°</span></div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> actionCreators === <span class="string">'function'</span>) &#123;</div><div class="line">    <span class="keyword">return</span> bindActionCreator(actionCreators, dispatch)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> actionCreators !== <span class="string">'object'</span> || actionCreators === <span class="literal">null</span>) &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(</div><div class="line">      <span class="string">`bindActionCreators expected an object or a function, instead received <span class="subst">$&#123;actionCreators === <span class="literal">null</span> ? <span class="string">'null'</span> : <span class="keyword">typeof</span> actionCreators&#125;</span>. `</span> +</div><div class="line">      <span class="string">`Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?`</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// éå†å¹¶é€šè¿‡bindActionCreatoråˆ†å‘ç»‘å®šè‡³dispatch</span></div><div class="line">  <span class="keyword">var</span> keys = <span class="built_in">Object</span>.keys(actionCreators)</div><div class="line">  <span class="keyword">var</span> boundActionCreators = &#123;&#125;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; keys.length; i++) &#123;</div><div class="line">    <span class="keyword">var</span> key = keys[i]</div><div class="line">    <span class="keyword">var</span> actionCreator = actionCreators[key]</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> actionCreator === <span class="string">'function'</span>) &#123;</div><div class="line">      boundActionCreators[key] = bindActionCreator(actionCreator, dispatch)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> boundActionCreators</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="react-redux"><a href="#react-redux" class="headerlink" title="react-redux"></a><code>react-redux</code></h3><h4 id="Provider"><a href="#Provider" class="headerlink" title="Provider"></a><code>Provider</code></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Provider</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  getChildContext() &#123;</div><div class="line">    <span class="comment">// å°†å…¶å£°æ˜ä¸º context çš„å±æ€§ä¹‹ä¸€</span></div><div class="line">    <span class="keyword">return</span> &#123; <span class="attr">store</span>: <span class="keyword">this</span>.store &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">constructor</span>(props, context) &#123;</div><div class="line">    <span class="keyword">super</span>(props, context)</div><div class="line">    <span class="comment">// æ¥æ”¶ redux çš„ store ä½œä¸º props</span></div><div class="line">    <span class="keyword">this</span>.store = props.store</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> Children.only(<span class="keyword">this</span>.props.children)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</div><div class="line">  Provider.prototype.componentWillReceiveProps = <span class="function"><span class="keyword">function</span> (<span class="params">nextProps</span>) </span>&#123;</div><div class="line">    <span class="keyword">const</span> &#123; store &#125; = <span class="keyword">this</span></div><div class="line">    <span class="keyword">const</span> &#123; <span class="attr">store</span>: nextStore &#125; = nextProps</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (store !== nextStore) &#123;</div><div class="line">      warnAboutReceivingStore()</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Provider.propTypes = &#123;</div><div class="line">  <span class="attr">store</span>: storeShape.isRequired,</div><div class="line">  <span class="attr">children</span>: PropTypes.element.isRequired</div><div class="line">&#125;</div><div class="line">Provider.childContextTypes = &#123;</div><div class="line">  <span class="attr">store</span>: storeShape.isRequired</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="connect"><a href="#connect" class="headerlink" title="connect"></a><code>connect</code></h4><p>ä¼ å…¥<code>mapStateToProps</code>,<code>mapDispatchToProps</code>,<code>mergeProps</code>,<code>options</code>ã€‚<br>é¦–å…ˆè·å–ä¼ å…¥çš„å‚æ•°ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä»¥é»˜è®¤å€¼ä»£æ›¿</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> defaultMapStateToProps = <span class="function"><span class="params">state</span> =&gt;</span> (&#123;&#125;) <span class="comment">// eslint-disable-line no-unused-vars</span></div><div class="line"><span class="keyword">const</span> defaultMapDispatchToProps = <span class="function"><span class="params">dispatch</span> =&gt;</span> (&#123; dispatch &#125;)</div><div class="line"><span class="keyword">const</span> &#123; pure = <span class="literal">true</span>, withRef = <span class="literal">false</span> &#125; = options</div></pre></td></tr></table></figure>
<p>ä¹‹åï¼Œé€šè¿‡</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> finalMergeProps = mergeProps || defaultMergeProps</div></pre></td></tr></table></figure>
<p>é€‰æ‹©åˆå¹¶<code>stateProps</code>,<code>dispatchProps</code>,<code>parentProps</code>çš„æ–¹å¼ï¼Œé»˜è®¤çš„åˆå¹¶æ–¹å¼ <code>defaultMergeProps</code> ä¸ºï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> defaultMergeProps = <span class="function">(<span class="params">stateProps, dispatchProps, parentProps</span>) =&gt;</span> (&#123;</div><div class="line">  ...parentProps,</div><div class="line">  ...stateProps,</div><div class="line">  ...dispatchProps</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>è¿”å›ä¸€ä¸ªä»¥ Component ä½œä¸ºå‚æ•°çš„å‡½æ•°ã€‚åœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨ï¼Œç”Ÿæˆäº†ä¸€ä¸ªå«åš<code>Connect</code>çš„ Component</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">wrapWithConnect</span>(<span class="params">WrappedComponent</span>) </span>&#123;</div><div class="line">    <span class="keyword">const</span> connectDisplayName = <span class="string">`Connect(<span class="subst">$&#123;getDisplayName(WrappedComponent)&#125;</span>)`</span></div><div class="line">    <span class="comment">// æ£€æŸ¥å‚æ•°åˆæ³•æ€§</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">checkStateShape</span>(<span class="params">props, methodName</span>) </span>&#123;&#125;</div><div class="line">    <span class="comment">// åˆå¹¶props</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">computeMergedProps</span>(<span class="params">stateProps, dispatchProps, parentProps</span>) </span>&#123;</div><div class="line">      <span class="keyword">const</span> mergedProps = finalMergeProps(stateProps, dispatchProps, parentProps)</div><div class="line">      <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</div><div class="line">        checkStateShape(mergedProps, <span class="string">'mergeProps'</span>)</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">return</span> mergedProps</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// start of Connect</span></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Connect</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">      <span class="keyword">constructor</span>(props, context) &#123;</div><div class="line">        <span class="keyword">super</span>(props, context);</div><div class="line">        <span class="keyword">this</span>.store = props.store || context.store</div><div class="line">        </div><div class="line">        <span class="keyword">const</span> storeState = <span class="keyword">this</span>.store.getState()</div><div class="line">        <span class="keyword">this</span>.state = &#123; storeState &#125;</div><div class="line">        <span class="keyword">this</span>.clearCache()</div><div class="line">      &#125;</div><div class="line">      </div><div class="line">      computeStateProps(store, props) &#123;</div><div class="line">        <span class="comment">// è°ƒç”¨configureFinalMapStateï¼Œä½¿ç”¨ä¼ å…¥çš„mapStateToPropsæ–¹æ³•ï¼ˆæˆ–é»˜è®¤æ–¹æ³•ï¼‰ï¼Œå°†state mapè¿›props</span></div><div class="line">      &#125;</div><div class="line">      configureFinalMapState(store, props) &#123;&#125;</div><div class="line">      </div><div class="line">      computeDispatchProps(store, props) &#123;</div><div class="line">        <span class="comment">// è°ƒç”¨configureFinalMapDispatchï¼Œä½¿ç”¨ä¼ å…¥çš„mapDispatchToPropsæ–¹æ³•ï¼ˆæˆ–é»˜è®¤æ–¹æ³•ï¼‰ï¼Œå°†actionä½¿ç”¨dispatchå°è£…mapè¿›props</span></div><div class="line">      &#125;</div><div class="line">      configureFinalMapDispatch(store, props) &#123;&#125;</div><div class="line">      </div><div class="line">      <span class="comment">// åˆ¤æ–­æ˜¯å¦æ›´æ–°props</span></div><div class="line">      updateStatePropsIfNeeded() &#123;&#125;</div><div class="line">      updateDispatchPropsIfNeeded() &#123;&#125;</div><div class="line">      updateMergedPropsIfNeeded() &#123;&#125;</div><div class="line">      </div><div class="line">      componentDidMount() &#123;</div><div class="line">        <span class="comment">// å†…éƒ¨è°ƒç”¨this.store.subscribe(this.handleChange.bind(this))</span></div><div class="line">        <span class="keyword">this</span>.trySubscribe()</div><div class="line">      &#125;</div><div class="line">      handleChange() &#123;</div><div class="line">        <span class="keyword">const</span> storeState = <span class="keyword">this</span>.store.getState()</div><div class="line">        <span class="keyword">const</span> prevStoreState = <span class="keyword">this</span>.state.storeState</div><div class="line">        <span class="comment">// å¯¹æ•°æ®è¿›è¡Œç›‘å¬ï¼Œå‘é€æ”¹å˜æ—¶è°ƒç”¨</span></div><div class="line">        <span class="keyword">this</span>.setState(&#123; storeState &#125;)</div><div class="line">      &#125;</div><div class="line">      </div><div class="line">      <span class="comment">// å–æ¶ˆç›‘å¬ï¼Œæ¸…é™¤ç¼“å­˜</span></div><div class="line">      componentWillUnmount() &#123;</div><div class="line">        <span class="keyword">this</span>.tryUnsubscribe()</div><div class="line">        <span class="keyword">this</span>.clearCache()</div><div class="line">      &#125;</div><div class="line">      </div><div class="line">      render() &#123;</div><div class="line">        <span class="keyword">this</span>.renderedElement = createElement(WrappedComponent,</div><div class="line">            <span class="keyword">this</span>.mergedProps</div><div class="line">        )</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.renderedElement</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// end of Connect</span></div><div class="line">    </div><div class="line">    Connect.displayName = connectDisplayName</div><div class="line">    Connect.WrappedComponent = WrappedComponent</div><div class="line">    Connect.contextTypes = &#123;</div><div class="line">      <span class="attr">store</span>: storeShape</div><div class="line">    &#125;</div><div class="line">    Connect.propTypes = &#123;</div><div class="line">      <span class="attr">store</span>: storeShape</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> hoistStatics(Connect, WrappedComponent)</div><div class="line">  &#125;</div><div class="line"><span class="comment">// ...</span></div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çœ‹è§ï¼Œåœ¨connectçš„æœ€åï¼Œè¿”å›äº†ä½¿ç”¨<code>hoistStatics</code>åŒ…è£…çš„<code>Connect</code>å’Œ<code>WrappedComponent</code></p>
<p><a href="https://github.com/mridgway/hoist-non-react-statics" target="_blank" rel="external">hoistStatics</a>æ˜¯ä»€ä¹ˆé¬¼ï¼Ÿ<a href="https://github.com/reactjs/react-redux/issues/276" target="_blank" rel="external">ä¸ºä»€ä¹ˆä½¿ç”¨å®ƒ?</a></p>
<blockquote>
<p>Copies non-react specific statics from a child component to a parent component. Similar to Object.assign, but with React static keywords blacklisted from being overridden.</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒç±»ä¼¼äº<code>Object.assign</code>ï¼Œä½œç”¨æ˜¯å°†å­ç»„ä»¶ä¸­çš„ static æ–¹æ³•å¤åˆ¶è¿›çˆ¶ç»„ä»¶ï¼Œä½†ä¸ä¼šè¦†ç›–ç»„ä»¶ä¸­çš„å…³é”®å­—æ–¹æ³•(å¦‚ componentDidMount)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> hoistNonReactStatic <span class="keyword">from</span> <span class="string">'hoist-non-react-statics'</span>;</div><div class="line"></div><div class="line">hoistNonReactStatic(targetComponent, sourceComponent);</div></pre></td></tr></table></figure>
  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/Coding-Guide/">Home</a></li>
         
          <li><a href="/Coding-Guide/about/">About</a></li>
         
          <li><a href="/Coding-Guide/archives/">Articles</a></li>
         
          <li><a href="http://github.com/ecmadao">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><span class="toc-number">1.</span> <span class="toc-text">Reduxå…¥å‘è¿›é˜¶-æºç è§£æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#é¢„çƒ­"><span class="toc-number">1.1.</span> <span class="toc-text">é¢„çƒ­</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#æŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆcurryï¼‰"><span class="toc-number">1.1.1.</span> <span class="toc-text">æŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆcurryï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ä»£ç ç»„åˆï¼ˆcomposeï¼‰"><span class="toc-number">1.1.2.</span> <span class="toc-text">ä»£ç ç»„åˆï¼ˆcomposeï¼‰</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redux"><span class="toc-number">1.2.</span> <span class="toc-text">Redux</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#combineReducers"><span class="toc-number">1.2.1.</span> <span class="toc-text">combineReducers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#createStore"><span class="toc-number">1.2.2.</span> <span class="toc-text">createStore</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#thunkMiddleware"><span class="toc-number">1.2.3.</span> <span class="toc-text">thunkMiddleware</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#applyMiddleware"><span class="toc-number">1.2.4.</span> <span class="toc-text">applyMiddleware</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bindActionCreator"><span class="toc-number">1.2.5.</span> <span class="toc-text">bindActionCreator</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bindActionCreatoræºç è§£æ"><span class="toc-number">1.2.6.</span> <span class="toc-text">bindActionCreatoræºç è§£æ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#react-redux"><span class="toc-number">1.3.</span> <span class="toc-text">react-redux</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Provider"><span class="toc-number">1.3.1.</span> <span class="toc-text">Provider</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#connect"><span class="toc-number">1.3.2.</span> <span class="toc-text">connect</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/&text=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/&title=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/&is_video=false&description=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ&body=Check out this article: http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/&title=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/&title=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/&title=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/&title=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://ecmadao.com/Coding-Guide/2017/01/13/Notes/React/Redux/Reduxå…¥å‘è¿›é˜¶-æºç è§£æ/&name=Reduxå…¥å‘è¿›é˜¶-æºç è§£æ&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick='$("#share-footer").toggle();return false;'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2017 ecmadao
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/Coding-Guide/">Home</a></li>
         
          <li><a href="/Coding-Guide/about/">About</a></li>
         
          <li><a href="/Coding-Guide/archives/">Articles</a></li>
         
          <li><a href="http://github.com/ecmadao">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    <script src="/Coding-Guide/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/Coding-Guide/js/main.js"></script>
<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-86660611-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'ecmadao-blog';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


</body>
</html>
